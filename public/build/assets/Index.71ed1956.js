import{P as ye,R as ge,u as Ie,H as Be,e as Ee,F as he,g as b,f as ke,I as Ce,y as De,l as P,Y as Ve,Z as $e,r,o as g,n as I,w as l,a as t,S as V,T as $,m as o,E,q as _,t as m,J as f,U as w,b as v,L as H,p as Te}from"./main.d0ffa6eb.js";import{M as Ae}from"./MoonwalkerIcon.ec6772d4.js";import{_ as Se}from"./InvoiceIndexDropdown.aa111b89.js";import{_ as Ne}from"./SendInvoiceModal.67cc3524.js";const Pe=v("div",{class:"hidden w-8 h-0 mx-4 border border-gray-400 border-solid xl:block",style:{"margin-top":"1.5rem"}},null,-1),we={class:"pt-6"},Fe={class:"flex"},Ue={class:"relative table-container"},Re={class:"relative flex items-center justify-between h-10 mt-5 list-none border-b-2 border-gray-200 border-solid"},Oe={class:"flex text-sm font-medium cursor-pointer select-none text-primary-400"},Le={class:"absolute items-center left-6 top-2.5 select-none"},Me={class:"relative block"},xe={class:"flex justify-between"},qe={setup(We){const u=ye(),j=ge();Ie();const Y=Be(),{t:n}=Ee();he("$utils");const h=b(null),B=b(!1),q=b([{label:"Status",options:["ALL","DRAFT","DUE","SENT","VIEWED","OVERDUE","COMPLETED"]},{label:"Paid Status",options:["UNPAID","PAID","PARTIALLY_PAID"]},,]),z=b([{label:"Status",options:["DATE","INVOICE_NUMBER"]}]),F=b(!0),U=b(!0),c=b("general.draft");ke();const k=Ce();let s=De({customer_id:"",status:"DRAFT",from_date:"",to_date:"",invoice_number:"",sort_by:"DATE"});const R=P(()=>!u.invoiceTotalCount&&!F.value),T=P({get:()=>u.selectedInvoices,set:a=>u.selectInvoice(a)}),J=P(()=>[{key:"checkbox",thClass:"extra w-10",tdClass:"font-medium text-gray-900",placeholderClass:"w-10",sortable:!1},{key:"invoice_date",label:n("invoices.date"),thClass:"extra",tdClass:"font-medium"},{key:"invoice_number",label:n("invoices.number")},{key:"name",label:n("invoices.customer")},{key:"status",label:n("invoices.status")},{key:"due_amount",label:n("dashboard.recent_invoices_card.amount_due")},{key:"total",label:n("invoices.total"),tdClass:"font-medium text-gray-900"},{key:"actions",label:n("invoices.action"),tdClass:"text-right text-sm font-medium",thClass:"text-right",sortable:!1}]);Ve(s,()=>{Q()},{debounce:500}),$e(()=>{u.selectAllField&&u.selectAllInvoices()});function X(){return k.hasAbilities([f.DELETE_INVOICE,f.EDIT_INVOICE,f.VIEW_INVOICE,f.SEND_INVOICE])}async function O(a,i){s.status="",A()}function A(){h.value&&h.value.refresh()}async function Z({page:a,filter:i,sort:p}){let S={customer_id:s.customer_id,sort_by:s.sort_by,status:s.status,from_date:s.from_date,to_date:s.to_date,invoice_number:s.invoice_number,orderByField:p.fieldName||"created_at",orderBy:p.order||"desc",page:a};F.value=!0;let d=await u.fetchInvoices(S);return U.value=d.data.data.length>0,{data:d.data.data,pagination:{totalPages:d.data.meta.last_page,currentPage:a,totalCount:d.data.meta.total,limit:10}}}function K(a){if(c.value==a.title)return!0;switch(c.value=a.title,a.title){case n("general.draft"):s.status="DRAFT";break;case n("general.sent"):s.status="SENT";break;case n("general.due"):s.status="DUE";break;default:s.status="";break}}function Q(){u.$patch(a=>{a.selectedInvoices=[],a.selectAllField=!1}),A()}function L(){s.customer_id="",s.status="",s.from_date="",s.to_date="",s.invoice_number="",c.value=n("general.all")}async function ee(){j.openDialog({title:n("general.are_you_sure"),message:n("invoices.confirm_delete"),yesLabel:n("general.ok"),noLabel:n("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async a=>{a&&await u.deleteMultipleInvoices().then(i=>{i.data.success&&(A(),u.$patch(p=>{p.selectedInvoices=[],p.selectAllField=!1}))})})}function te(){B.value&&L(),B.value=!B.value}function ae(a){switch(a){case"DRAFT":c.value=n("general.draft");break;case"ALL":c.value=n("general.all");break;case"SENT":c.value=n("general.sent");break;case"DUE":c.value=n("general.due");break;case"COMPLETED":c.value=n("invoices.completed");break;case"PAID":c.value=n("invoices.paid");break;case"UNPAID":c.value=n("invoices.unpaid");break;case"PARTIALLY_PAID":c.value=n("invoices.partially_paid");break;case"VIEWED":c.value=n("invoices.viewed");break;case"OVERDUE":c.value=n("invoices.overdue");break;default:c.value=n("general.all");break}}function le(a){switch(a){case"DATE":s.sort_by="DATE";break;case"INVOICE_NUMBER":s.sort_by="INVOICE_NUMBER";break;default:s.sort_by="DATE";break}}return(a,i)=>{const p=r("BaseBreadcrumbItem"),S=r("BaseBreadcrumb"),d=r("BaseIcon"),C=r("BaseButton"),N=r("router-link"),se=r("BasePageHeader"),oe=r("BaseCustomerSelectInput"),y=r("BaseInputGroup"),M=r("BaseMultiselect"),x=r("BaseDatePicker"),ne=r("BaseInput"),ie=r("BaseFilterWrapper"),re=r("BaseEmptyPlaceholder"),D=r("BaseTab"),ue=r("BaseTabGroup"),ce=r("BaseDropdownItem"),de=r("BaseDropdown"),W=r("BaseCheckbox"),me=r("BaseText"),G=r("BaseFormatMoney"),_e=r("BaseInvoiceStatusBadge"),ve=r("BasePaidStatusBadge"),pe=r("BaseTable"),be=r("BasePage");return g(),I(be,null,{default:l(()=>[t(Ne),t(se,{title:a.$t("invoices.title")},{actions:l(()=>[V(t(C,{variant:"primary-outline",onClick:te},{right:l(e=>[B.value?(g(),I(d,{key:1,name:"XIcon",class:E(e.class)},null,8,["class"])):(g(),I(d,{key:0,name:"FilterIcon",class:E(e.class)},null,8,["class"]))]),default:l(()=>[_(m(a.$t("general.filter"))+" ",1)]),_:1},512),[[$,o(u).invoiceTotalCount]]),o(k).hasAbilities(o(f).CREATE_INVOICE)?(g(),I(N,{key:0,to:"invoices/create"},{default:l(()=>[t(C,{variant:"primary",class:"ml-4"},{left:l(e=>[t(d,{name:"PlusIcon",class:E(e.class)},null,8,["class"])]),default:l(()=>[_(" "+m(a.$t("invoices.new_invoice")),1)]),_:1})]),_:1})):w("",!0)]),default:l(()=>[t(S,null,{default:l(()=>[t(p,{title:a.$t("general.home"),to:"dashboard"},null,8,["title"]),t(p,{title:a.$tc("invoices.invoice",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),V(t(ie,{"row-on-xl":!0,onClear:L},{default:l(()=>[t(y,{label:a.$tc("customers.customer",1)},{default:l(()=>[t(oe,{modelValue:o(s).customer_id,"onUpdate:modelValue":i[0]||(i[0]=e=>o(s).customer_id=e),placeholder:a.$t("customers.type_or_click"),"value-prop":"id",label:"name"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(y,{label:a.$t("invoices.status")},{default:l(()=>[t(M,{modelValue:o(s).status,"onUpdate:modelValue":[i[1]||(i[1]=e=>o(s).status=e),ae],groups:!0,options:q.value,searchable:"",placeholder:a.$t("general.select_a_status"),onRemove:i[2]||(i[2]=e=>O())},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"]),t(y,{label:a.$t("general.from")},{default:l(()=>[t(x,{modelValue:o(s).from_date,"onUpdate:modelValue":i[3]||(i[3]=e=>o(s).from_date=e),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),Pe,t(y,{label:a.$t("general.to"),class:"mt-2"},{default:l(()=>[t(x,{modelValue:o(s).to_date,"onUpdate:modelValue":i[4]||(i[4]=e=>o(s).to_date=e),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),t(y,{label:a.$t("invoices.invoice_number")},{default:l(()=>[t(ne,{modelValue:o(s).invoice_number,"onUpdate:modelValue":i[5]||(i[5]=e=>o(s).invoice_number=e)},{left:l(e=>[t(d,{name:"HashtagIcon",class:E(e.class)},null,8,["class"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(y,{label:a.$t("general.sort_by")},{default:l(()=>[t(M,{modelValue:o(s).sort_by,"onUpdate:modelValue":[i[6]||(i[6]=e=>o(s).sort_by=e),le],groups:!0,options:z.value,placeholder:a.$t("general.select_a_sort_by"),onRemove:i[7]||(i[7]=e=>O())},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"]),v("div",we,[U.value?(g(),I(N,{key:0,to:`/filtered-invoices-list?selectedCompany=${o(Y).selectedCompany.id}&customer_id=${o(s).customer_id}&status=${o(s).status}&from_date=${o(s).from_date}&to_date=${o(s).to_date}&invoice_number=${o(s).invoice_number}&sort_by=${o(s).sort_by}`,target:"_blank"},{default:l(()=>[t(C,{class:"mr-3",variant:"primary-outline",type:"button"},{default:l(()=>[v("span",Fe,m(a.$t("Download")),1)]),_:1})]),_:1},8,["to"])):w("",!0)])]),_:1},512),[[$,B.value]]),V(t(re,{title:a.$t("invoices.no_invoices"),description:a.$t("invoices.list_of_invoices")},H({default:l(()=>[t(Ae,{class:"mt-5 mb-4"})]),_:2},[o(k).hasAbilities(o(f).CREATE_INVOICE)?{name:"actions",fn:l(()=>[t(C,{variant:"primary-outline",onClick:i[8]||(i[8]=e=>a.$router.push("/admin/invoices/create"))},{left:l(e=>[t(d,{name:"PlusIcon",class:E(e.class)},null,8,["class"])]),default:l(()=>[_(" "+m(a.$t("invoices.add_new_invoice")),1)]),_:1})])}:void 0]),1032,["title","description"]),[[$,o(R)]]),V(v("div",Ue,[v("div",Re,[t(ue,{class:"-mb-5",onChange:K},{default:l(()=>[t(D,{title:a.$t("general.draft"),filter:"DRAFT"},null,8,["title"]),t(D,{title:a.$t("general.due"),filter:"DUE"},null,8,["title"]),t(D,{title:a.$t("general.sent"),filter:"SENT"},null,8,["title"]),t(D,{title:a.$t("general.all"),filter:""},null,8,["title"])]),_:1}),o(u).selectedInvoices.length&&o(k).hasAbilities(o(f).DELETE_INVOICE)?(g(),I(de,{key:0,class:"absolute float-right"},{activator:l(()=>[v("span",Oe,[_(m(a.$t("general.actions"))+" ",1),t(d,{name:"ChevronDownIcon"})])]),default:l(()=>[t(ce,{onClick:ee},{default:l(()=>[t(d,{name:"TrashIcon",class:"mr-3 text-gray-600"}),_(" "+m(a.$t("general.delete")),1)]),_:1})]),_:1})):w("",!0)]),t(pe,{ref_key:"table",ref:h,data:Z,columns:o(J),"placeholder-count":o(u).invoiceTotalCount>=20?10:5,class:"mt-10"},H({header:l(()=>[v("div",Le,[t(W,{modelValue:o(u).selectAllField,"onUpdate:modelValue":i[9]||(i[9]=e=>o(u).selectAllField=e),variant:"primary",onChange:o(u).selectAllInvoices},null,8,["modelValue","onChange"])])]),"cell-checkbox":l(({row:e})=>[v("div",Me,[t(W,{id:e.id,modelValue:o(T),"onUpdate:modelValue":i[10]||(i[10]=fe=>Te(T)?T.value=fe:null),value:e.data.id},null,8,["id","modelValue","value"])])]),"cell-name":l(({row:e})=>[t(me,{text:e.data.customer.name,length:30},null,8,["text"])]),"cell-invoice_number":l(({row:e})=>[t(N,{to:{path:`invoices/${e.data.id}/view`},class:"font-medium text-primary-500"},{default:l(()=>[_(m(e.data.invoice_number),1)]),_:2},1032,["to"])]),"cell-invoice_date":l(({row:e})=>[_(m(e.data.formatted_invoice_date),1)]),"cell-total":l(({row:e})=>[t(G,{amount:e.data.total,currency:e.data.customer.currency},null,8,["amount","currency"])]),"cell-status":l(({row:e})=>[t(_e,{status:e.data.status,class:"px-3 py-1"},{default:l(()=>[_(m(e.data.status),1)]),_:2},1032,["status"])]),"cell-due_amount":l(({row:e})=>[v("div",xe,[t(G,{amount:e.data.due_amount,currency:e.data.currency},null,8,["amount","currency"]),t(ve,{status:e.data.paid_status,class:"px-1 py-0.5 ml-2"},{default:l(()=>[_(m(e.data.paid_status),1)]),_:2},1032,["status"])])]),_:2},[X()?{name:"cell-actions",fn:l(({row:e})=>[t(Se,{row:e.data,table:h.value},null,8,["row","table"])])}:void 0]),1032,["columns","placeholder-count"])],512),[[$,!o(R)]])]),_:1})}}};export{qe as default};
