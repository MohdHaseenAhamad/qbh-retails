import{Q as te,P as ae,u as se,I as oe,R as ne,e as le,F as re,g as u,x as ie,f as de,y as ce,l as h,K as ue,ab as me,r as d,o as i,c as B,a,n as f,w as n,b as c,m as s,J as V,q as E,t as p,U as v,aa as R,a9 as fe,E as ve}from"./main.d0ffa6eb.js";import{_ as _e}from"./InvoiceIndexDropdown.aa111b89.js";import{_ as pe}from"./SendInvoiceModal.67cc3524.js";import{L as ye}from"./LoadingIcon.272413e7.js";const be={class:"text-sm mr-3"},ge={class:"fixed top-0 left-0 hidden h-full pt-16 pb-4 ml-56 bg-white xl:ml-64 w-88 xl:block"},he={class:"flex items-center justify-between px-4 pt-8 pb-2 border border-gray-200 border-solid height-full"},Be={class:"mb-6"},xe={class:"flex mb-6 ml-3",role:"group","aria-label":"First group"},Ie={class:"px-2 py-1 pb-2 mb-1 mb-2 text-sm border-b border-gray-200 border-solid"},Ee={key:0,class:"h-full pb-32 overflow-y-scroll border-l border-gray-200 border-solid base-scroll"},ke={class:"flex-2"},we={class:"mt-1 mb-2 text-xs not-italic font-medium leading-5 text-gray-600"},Se={class:"flex-1 whitespace-nowrap right"},Te={class:"text-sm not-italic font-normal leading-5 text-right text-gray-600 est-date"},De={class:"flex justify-center p-4 items-center"},Ve={key:0,class:"flex justify-center px-4 mt-5 text-sm text-gray-600"},$e={class:"flex flex-col min-h-0 mt-8 overflow-hidden",style:{height:"75vh"}},Fe=["src"],ze={setup(Ne){const U=te(),m=ae();se();const k=oe(),z=ne(),{t:y}=le();re("$utils"),u(null),u(null);const l=u(null);u(null);const x=ie();de(),u(["DRAFT","SENT","VIEWED","EXPIRED","ACCEPTED","REJECTED"]);const w=u(!1),L=u(!1);u(!1);const $=u(!1),b=u(!1),t=ce({orderBy:null,orderByField:null,searchText:null}),M=h(()=>l.value.invoice_number),F=h(()=>t.orderBy==="asc"||t.orderBy==null);h(()=>F.value?y("general.ascending"):y("general.descending"));const P=h(()=>`/invoices/pdf/${l.value.unique_hash}`);h(()=>l.value&&l.value.id?invoice.value.id:null),ue(x,(e,r)=>{e.name==="invoices.view"&&A()});async function j(){z.openDialog({title:y("general.are_you_sure"),message:y("invoices.invoice_mark_as_sent"),yesLabel:y("general.ok"),noLabel:y("general.cancel"),variant:"primary",hideNoButton:!1,size:"lg"}).then(async e=>{w.value=!1,e&&(await m.markAsSent({id:l.value.id,status:"SENT"}).then(r=>{window.location.href=window.location.href}),l.value.status="SENT",w.value=!0)})}async function O(e){U.openModal({title:y("invoices.send_invoice"),componentName:"SendInvoiceModal",id:l.value.id,data:l.value})}function q(e){return x.params.id==e}async function N(){b.value=!0,await m.fetchInvoices(),b.value=!1,setTimeout(()=>{G()},500)}function G(){const e=document.getElementById(`invoice-${x.params.id}`);e&&(e.scrollIntoView({behavior:"smooth"}),e.classList.add("shake"))}async function A(){let e=await m.fetchInvoice(x.params.id);e.data&&(l.value={...e.data.data})}async function _(){let e="";t.searchText!==""&&t.searchText!==null&&t.searchText!==void 0&&(e+=`search=${t.searchText}&`),t.orderBy!==null&&t.orderBy!==void 0&&(e+=`orderBy=${t.orderBy}&`),t.orderByField!==null&&t.orderByField!==void 0&&(e+=`orderByField=${t.orderByField}`),$.value=!0;let r=await m.searchInvoice(e);$.value=!1,r.data&&(m.invoices=r.data.data)}function H(){return t.orderBy==="asc"?(t.orderBy="desc",_(),!0):(t.orderBy="asc",_(),!0)}return N(),A(),_=me.exports.debounce(_,500),(e,r)=>{const g=d("BaseButton"),C=d("router-link"),J=d("BasePageHeader"),I=d("BaseIcon"),W=d("BaseInput"),S=d("BaseRadio"),T=d("BaseInputGroup"),D=d("BaseDropdownItem"),K=d("BaseDropdown"),Q=d("BaseText"),X=d("BaseEstimateStatusBadge"),Y=d("BaseFormatMoney"),Z=d("BasePage");return i(),B(R,null,[a(pe),l.value?(i(),f(Z,{key:0,class:"xl:pl-96 xl:ml-8"},{default:n(()=>[a(J,{title:s(M)},{actions:n(()=>[c("div",be,[l.value.sent!="1"&&(l.value.status=="DRAFT"||l.value.status=="OVERDUE")&&s(k).hasAbilities(s(V).EDIT_INVOICE)?(i(),f(g,{key:0,disabled:w.value,variant:"primary-outline",onClick:j},{default:n(()=>[E(p(e.$t("invoices.mark_as_sent")),1)]),_:1},8,["disabled"])):v("",!0)]),l.value.status==="DRAFT"&&s(k).hasAbilities(s(V).SEND_INVOICE)?(i(),f(g,{key:0,disabled:L.value,variant:"primary",class:"text-sm",onClick:O},{default:n(()=>[E(p(e.$t("invoices.send_invoice")),1)]),_:1},8,["disabled"])):v("",!0),s(k).hasAbilities(s(V).CREATE_PAYMENT)?(i(),f(C,{key:1,to:`/admin/payments/${e.$route.params.id}/create`},{default:n(()=>[l.value.status==="SENT"||l.value.status==="OVERDUE"||l.value.status==="VIEWED"?(i(),f(g,{key:0,variant:"primary"},{default:n(()=>[E(p(e.$t("invoices.record_payment")),1)]),_:1})):v("",!0)]),_:1},8,["to"])):v("",!0),a(_e,{class:"ml-3",row:l.value,"load-data":N},null,8,["row"])]),_:1},8,["title"]),c("div",ge,[c("div",he,[c("div",Be,[a(W,{modelValue:s(t).searchText,"onUpdate:modelValue":r[0]||(r[0]=o=>s(t).searchText=o),placeholder:e.$t("general.search"),type:"text",variant:"gray",onInput:r[1]||(r[1]=o=>_())},{right:n(()=>[a(I,{name:"SearchIcon",class:"h-5 text-gray-400"})]),_:1},8,["modelValue","placeholder"])]),c("div",xe,[a(K,{class:"ml-3",position:"bottom-start"},{activator:n(()=>[a(g,{size:"md",variant:"gray"},{default:n(()=>[a(I,{name:"FilterIcon"})]),_:1})]),default:n(()=>[c("div",Ie,p(e.$t("general.sort_by")),1),a(D,{class:"flex px-1 py-2 cursor-pointer"},{default:n(()=>[a(T,{class:"-mt-3 font-normal"},{default:n(()=>[a(S,{id:"filter_invoice_date",modelValue:s(t).orderByField,"onUpdate:modelValue":[r[2]||(r[2]=o=>s(t).orderByField=o),_],label:e.$t("reports.invoices.invoice_date"),size:"sm",name:"filter",value:"invoice_date"},null,8,["modelValue","label"])]),_:1})]),_:1}),a(D,{class:"flex px-1 py-2 cursor-pointer"},{default:n(()=>[a(T,{class:"-mt-3 font-normal"},{default:n(()=>[a(S,{id:"filter_due_date",modelValue:s(t).orderByField,"onUpdate:modelValue":[r[3]||(r[3]=o=>s(t).orderByField=o),_],label:e.$t("invoices.due_date"),value:"due_date",size:"sm",name:"filter"},null,8,["modelValue","label"])]),_:1})]),_:1}),a(D,{class:"flex px-1 py-2 cursor-pointer"},{default:n(()=>[a(T,{class:"-mt-3 font-normal"},{default:n(()=>[a(S,{id:"filter_invoice_number",modelValue:s(t).orderByField,"onUpdate:modelValue":[r[4]||(r[4]=o=>s(t).orderByField=o),_],label:e.$t("invoices.invoice_number"),value:"invoice_number",size:"sm",name:"filter"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),a(g,{class:"ml-1",size:"md",variant:"gray",onClick:H},{default:n(()=>[s(F)?(i(),f(I,{key:0,name:"SortAscendingIcon"})):(i(),f(I,{key:1,name:"SortDescendingIcon"}))]),_:1})])]),s(m)&&s(m).invoices?(i(),B("div",Ee,[(i(!0),B(R,null,fe(s(m).invoices,(o,ee)=>(i(),B("div",{key:ee},[o&&!b.value?(i(),f(C,{key:0,id:"invoice-"+o.id,to:`/admin/invoices/${o.id}/view`,class:ve(["flex justify-between side-invoice p-4 cursor-pointer hover:bg-gray-100 items-center border-l-4 border-transparent",{"bg-gray-100 border-l-4 border-primary-500 border-solid":q(o.id)}]),style:{"border-bottom":"1px solid rgba(185, 193, 209, 0.41)"}},{default:n(()=>[c("div",ke,[a(Q,{text:o.customer.name,length:30,class:"pr-2 mb-2 text-sm not-italic font-normal leading-5 text-black capitalize"},null,8,["text"]),c("div",we,p(o.invoice_number),1),a(X,{status:o.status,class:"px-1 text-xs"},{default:n(()=>[E(p(o.status),1)]),_:2},1032,["status"])]),c("div",Se,[a(Y,{class:"mb-2 text-xl not-italic font-semibold leading-8 text-right text-gray-900 block",amount:o.total,currency:o.customer.currency},null,8,["amount","currency"]),c("div",Te,p(o.formatted_invoice_date),1)])]),_:2},1032,["id","to","class"])):v("",!0)]))),128)),c("div",De,[b.value?(i(),f(ye,{key:0,class:"h-6 m-1 animate-spin text-primary-400"})):v("",!0)]),!s(m).invoices.length&&!b.value?(i(),B("p",Ve,p(e.$t("invoices.no_matching_invoices")),1)):v("",!0)])):v("",!0)]),c("div",$e,[c("iframe",{src:`${s(P)}`,class:"flex-1 border border-gray-400 border-solid bg-white rounded-md frame-style"},null,8,Fe)])]),_:1})):v("",!0)],64)}}};export{ze as default};
