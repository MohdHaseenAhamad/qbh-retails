import{al as E,r as i,o as w,c as T,a as n,w as o,m as a,H as J,a1 as Q,ao as W,e as X,x as Y,f as Z,g as M,l as L,h as g,i as $,a4 as x,a5 as ee,aP as ae,k as ne,K as te,b as y,n as _,t as S,U as q,E as F,q as G,s as oe,aa as le}from"./main.d0ffa6eb.js";import{_ as se,a as re,b as ie,c as ue,d as de}from"./ItemModal.720790e2.js";import{_ as ce}from"./ExchangeRateConverter.ef383681.js";import{_ as me}from"./TaxTypeModal.fd62b2ec.js";import{_ as ge}from"./PreparedByModal.fa78cd8f.js";import"./DragIcon.e0a4ab5f.js";import"./ItemUnitModal.dc6156ec.js";import"./SelectNotePopup.f61bb6cc.js";import"./NoteModal.688693f3.js";/* empty css                                                  */const pe={class:"grid grid-cols-12 gap-8 mt-6 mb-8"},he={props:{v:{type:Object,default:null},isLoading:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1}},setup(t){const e=E();return(u,l)=>{const d=i("BaseCustomerSelectPopup"),c=i("BaseInputGroup"),p=i("BaseInput"),h=i("BaseDatePicker"),m=i("BaseInputGrid");return w(),T("div",pe,[n(m,{class:"col-span-12 sm:grid-cols-4 md:grid-cols-4"},{default:o(()=>[n(c,{label:u.$t("debits.supplier"),"content-loading":t.isLoading,required:""},{default:o(()=>[n(d,{modelValue:a(e).newPurchase.customer,"onUpdate:modelValue":l[0]||(l[0]=s=>a(e).newPurchase.customer=s),valid:t.v.customer_id,"content-loading":t.isLoading,type:"purchase",class:"col-span-12 lg:col-span-5 pr-0"},null,8,["modelValue","valid","content-loading"])]),_:1},8,["label","content-loading"]),n(c,{label:u.$t("purchases.number"),"content-loading":t.isLoading,error:t.v.purchase_no.$error&&t.v.purchase_no.$errors[0].$message,required:""},{default:o(()=>[n(p,{disabled:"",modelValue:a(e).newPurchase.purchase_no,"onUpdate:modelValue":l[1]||(l[1]=s=>a(e).newPurchase.purchase_no=s),"content-loading":t.isLoading,onInput:l[2]||(l[2]=s=>t.v.purchase_no.$touch())},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading","error"]),n(c,{label:u.$t("purchases.date"),"content-loading":t.isLoading,required:"",error:t.v.purchase_date.$error&&t.v.purchase_date.$errors[0].$message},{default:o(()=>[n(h,{modelValue:a(e).newPurchase.purchase_date,"onUpdate:modelValue":l[3]||(l[3]=s=>a(e).newPurchase.purchase_date=s),"content-loading":t.isLoading,"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading","error"]),n(c,{label:u.$t("purchases.invoice_no"),"content-loading":t.isLoading,error:t.v.invoice_no.$error&&t.v.invoice_no.$errors[0].$message,required:""},{default:o(()=>[n(p,{modelValue:a(e).newPurchase.invoice_no,"onUpdate:modelValue":l[4]||(l[4]=s=>a(e).newPurchase.invoice_no=s),"content-loading":t.isLoading},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading","error"]),n(c,{label:u.$t("purchases.invoice_date"),"content-loading":t.isLoading,required:"",error:t.v.invoice_date.$error&&t.v.invoice_date.$errors[0].$message},{default:o(()=>[n(h,{modelValue:a(e).newPurchase.invoice_date,"onUpdate:modelValue":l[5]||(l[5]=s=>a(e).newPurchase.invoice_date=s),"content-loading":t.isLoading,"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading","error"]),n(c,{label:u.$t("purchases.order_no"),"content-loading":t.isLoading},{default:o(()=>[n(p,{modelValue:a(e).newPurchase.order_no,"onUpdate:modelValue":l[6]||(l[6]=s=>a(e).newPurchase.order_no=s),"content-loading":t.isLoading},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),n(c,{label:u.$t("purchases.order_date"),"content-loading":t.isLoading},{default:o(()=>[n(h,{modelValue:a(e).newPurchase.order_date,"onUpdate:modelValue":l[7]||(l[7]=s=>a(e).newPurchase.order_date=s),"content-loading":t.isLoading,"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),n(c,{label:u.$t("purchases.material_receipt_no"),"content-loading":t.isLoading},{default:o(()=>[n(p,{modelValue:a(e).newPurchase.material_receipt,"onUpdate:modelValue":l[8]||(l[8]=s=>a(e).newPurchase.material_receipt=s),"content-loading":t.isLoading},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),n(c,{label:u.$t("purchases.supply_date"),"content-loading":t.isLoading},{default:o(()=>[n(h,{modelValue:a(e).newPurchase.supply_date,"onUpdate:modelValue":l[9]||(l[9]=s=>a(e).newPurchase.supply_date=s),"content-loading":t.isLoading,"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),n(c,{label:u.$t("purchases.reference_number"),"content-loading":t.isLoading},{default:o(()=>[n(p,{modelValue:a(e).newPurchase.reference_number,"onUpdate:modelValue":l[10]||(l[10]=s=>a(e).newPurchase.reference_number=s),"content-loading":t.isLoading},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),n(ce,{store:a(e),"store-prop":"newPurchase",v:t.v,"is-loading":t.isLoading,"is-edit":t.isEdit,"customer-currency":a(e).newPurchase.currency_id},null,8,["store","v","is-loading","is-edit","customer-currency"])]),_:1})])}}},ve=["onSubmit"],fe={class:"flex"},be={class:"block mt-10 invoice-foot lg:flex lg:justify-between lg:items-start"},we={class:"relative w-full lg:w-1/2 lg:mr-4"},Pe=y("br",null,null,-1),ke={setup(t){const e=E(),u=J(),l=Q();W();const{t:d}=X();let c=Y(),p=Z();const h="newPurchase";let m=M(!1);const s=M(["customer","company","customerCustom","invoice","invoiceCustom"]);let v=L(()=>e.isFetchingPurchase||e.isFetchingInitialSettings),N=L(()=>B.value?d("purchases.edit_purchase"):d("purchases.new_purchase")),B=L(()=>c.name==="purchases.edit");const D={invoice_no:{required:g.withMessage(d("validation.required"),$)},invoice_date:{required:g.withMessage(d("validation.required"),$)},reference_number:{maxLength:g.withMessage(d("validation.price_maxlength"),x(255))},customer_id:{required:g.withMessage(d("validation.required"),$)},purchase_no:{required:g.withMessage(d("validation.required"),$)},purchase_date:{required:g.withMessage(d("validation.required"),$)},exchange_rate:{required:ee(function(){return g.withMessage(d("validation.required"),$),e.showExchangeRate}),decimal:g.withMessage(d("validation.valid_exchange_rate"),ae)}},V=ne(D,L(()=>e.newPurchase),{$scope:h});l.resetCustomFields(),V.value.$reset,e.resetCurrentPurchase(),e.fetchPurchaseInitialSettings(B.value),te(()=>e.newPurchase.customer,r=>{r&&r.currency?e.newPurchase.selectedCurrency=r.currency:e.newPurchase.selectedCurrency=u.selectedCompanyCurrency});async function H(){if(V.value.$touch(),V.value.$invalid)return!1;m.value=!0;let r={...e.newPurchase,sub_total:e.getSubTotal,total:e.getTotal,tax:e.getTotalTax};try{const P=await(B.value?e.updatePurchase:e.addPurchase)(r);p.push(`/admin/purchases/${P.data.data.id}/view`)}catch(f){console.error(f)}m.value=!1}return(r,f)=>{const P=i("BaseBreadcrumbItem"),R=i("BaseBreadcrumb"),I=i("BaseButton"),j=i("router-link"),C=i("BaseIcon"),z=i("BasePageHeader"),k=i("BaseInput"),U=i("BaseInputGroup"),K=i("BaseInputGrid"),O=i("BaseScrollPane"),A=i("BasePage");return w(),T(le,null,[n(se),n(re),n(ge),n(me),n(A,{class:"relative invoice-create-page"},{default:o(()=>[y("form",{onSubmit:oe(H,["prevent"])},[n(z,{title:a(N)},{actions:o(()=>[r.$route.name==="purchase.edit"?(w(),_(j,{key:0,to:`/purchases/pdf/${a(e).newPurchase.unique_hash}`,target:"_blank"},{default:o(()=>[n(I,{class:"mr-3",variant:"primary-outline",type:"button"},{default:o(()=>[y("span",fe,S(r.$t("general.view_pdf")),1)]),_:1})]),_:1},8,["to"])):q("",!0),n(I,{loading:a(m),disabled:a(m),variant:"primary",type:"submit"},{left:o(b=>[a(m)?q("",!0):(w(),_(C,{key:0,name:"SaveIcon",class:F(b.class)},null,8,["class"]))]),default:o(()=>[G(" "+S(r.$t("purchases.save_purchase")),1)]),_:1},8,["loading","disabled"])]),default:o(()=>[n(R,null,{default:o(()=>[n(P,{title:r.$t("general.home"),to:"/admin/dashboard"},null,8,["title"]),n(P,{title:r.$tc("purchases.purchase",2),to:"/admin/purchases"},null,8,["title"]),r.$route.name==="purchases.edit"?(w(),_(P,{key:0,title:r.$t("purchases.edit_purchase"),to:"#",active:""},null,8,["title"])):(w(),_(P,{key:1,title:r.$t("purchases.new_purchase"),to:"#",active:""},null,8,["title"]))]),_:1})]),_:1},8,["title"]),n(he,{v:a(V),"is-loading":a(v),"is-edit":a(B)},null,8,["v","is-loading","is-edit"]),n(O,null,{default:o(()=>[n(ie,{currency:a(e).newPurchase.selectedCurrency,"is-loading":a(v),"item-validation-scope":h,store:a(e),"store-prop":"newPurchase"},null,8,["currency","is-loading","store"]),y("div",be,[y("div",we,[n(ue,{store:a(e),"store-prop":"newPurchase",fields:s.value,type:"Purchase"},null,8,["store","fields"])]),n(de,{currency:a(e).newPurchase.selectedCurrency,"is-loading":a(v),store:a(e),"store-prop":"newPurchase","tax-popup-type":"invoice"},null,8,["currency","is-loading","store"])]),n(K,{class:"col-span-12"},{default:o(()=>[n(U,{label:r.$t("invoices.upper_margin"),"content-loading":a(v)},{default:o(()=>[n(k,{modelValue:a(e).newPurchase.upper_margin,"onUpdate:modelValue":f[0]||(f[0]=b=>a(e).newPurchase.upper_margin=b),"content-loading":a(v)},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),n(U,{label:r.$t("invoices.lower_margin"),"content-loading":a(v)},{default:o(()=>[n(k,{modelValue:a(e).newPurchase.lower_margin,"onUpdate:modelValue":f[1]||(f[1]=b=>a(e).newPurchase.lower_margin=b),"content-loading":a(v)},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"])]),_:1}),Pe,n(I,{loading:a(m),disabled:a(m),variant:"primary",type:"submit"},{left:o(b=>[a(m)?q("",!0):(w(),_(C,{key:0,name:"SaveIcon",class:F(b.class)},null,8,["class"]))]),default:o(()=>[G(" "+S(r.$t("purchases.save_purchase")),1)]),_:1},8,["loading","disabled"])]),_:1})],40,ve)]),_:1})],64)}}};export{ke as default};
