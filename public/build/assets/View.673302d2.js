import{X as M,x as L,e as O,g as S,y as R,ab as J,l as w,r as c,o as n,c as B,b as o,a as t,w as a,m as e,t as g,n as _,aa as U,a9 as z,U as p,E as H,q as E,_ as K,H as Q,F as Y,K as W,p as Z,R as ee,I as te,f as se,J as C}from"./main.d0ffa6eb.js";import{L as ae}from"./LoadingIcon.272413e7.js";import{_ as ne}from"./LineChart.1e31d5cb.js";import{_ as oe}from"./CustomerIndexDropdown.35bfc532.js";import"./Chart.b01f5b76.js";const le={class:"fixed top-0 left-0 hidden h-full pt-16 pb-4 ml-56 bg-white xl:ml-64 w-88 xl:block"},re={class:"flex items-center justify-between px-4 pt-8 pb-2 border border-gray-200 border-solid height-full"},ce={class:"flex mb-6 ml-3",role:"group","aria-label":"First group"},ie={class:"px-4 py-3 pb-2 mb-2 text-sm border-b border-gray-200 border-solid"},de={class:"px-2"},ue={class:"px-2"},me={class:"h-full pb-32 overflow-y-scroll border-l border-gray-200 border-solid sidebar base-scroll"},_e={class:"flex-1 font-bold text-right whitespace-nowrap"},pe={class:"flex justify-center p-4 items-center"},fe={key:0,class:"flex justify-center px-4 mt-5 text-sm text-gray-600"},he={setup(F){const h=M(),s=L(),{t:d}=O();let r=S(!1),i=S(!1),l=R({orderBy:"",orderByField:"",searchText:""});v=J.exports.debounce(v,500);const $=w(()=>l.orderBy==="asc"||l.orderBy==null);w(()=>$.value?d("general.ascending"):d("general.descending"));function x(u){return s.params.id==u}async function T(){i.value=!0,await h.fetchCustomers({limit:"all"}),i.value=!1,setTimeout(()=>{y()},500)}function y(){const u=document.getElementById(`customer-${s.params.id}`);u&&(u.scrollIntoView({behavior:"smooth"}),u.classList.add("shake"))}async function v(){let u={};l.searchText!==""&&l.searchText!==null&&l.searchText!==void 0&&(u.display_name=l.searchText),l.orderBy!==null&&l.orderBy!==void 0&&(u.orderBy=l.orderBy),l.orderByField!==null&&l.orderByField!==void 0&&(u.orderByField=l.orderByField),r.value=!0;try{let f=await h.fetchCustomers(u);r.value=!1,f.data&&(h.customers=f.data.data)}catch{r.value=!1}}function D(){return l.orderBy==="asc"?(l.orderBy="desc",v(),!0):(l.orderBy="asc",v(),!0)}return T(),(u,f)=>{const m=c("BaseIcon"),k=c("BaseInput"),I=c("BaseButton"),A=c("BaseRadio"),V=c("BaseInputGroup"),P=c("BaseDropdownItem"),j=c("BaseDropdown"),N=c("BaseText"),X=c("BaseFormatMoney"),q=c("router-link");return n(),B("div",le,[o("div",re,[t(k,{modelValue:e(l).searchText,"onUpdate:modelValue":f[0]||(f[0]=b=>e(l).searchText=b),placeholder:u.$t("general.search"),"container-class":"mb-6",type:"text",variant:"gray",onInput:f[1]||(f[1]=b=>v())},{default:a(()=>[t(m,{name:"SearchIcon",class:"text-gray-500"})]),_:1},8,["modelValue","placeholder"]),o("div",ce,[t(j,{"close-on-select":!1,position:"bottom-start","width-class":"w-40","position-class":"left-0"},{activator:a(()=>[t(I,{variant:"gray"},{default:a(()=>[t(m,{name:"FilterIcon"})]),_:1})]),default:a(()=>[o("div",ie,g(u.$t("general.sort_by")),1),o("div",de,[t(P,{class:"flex px-1 py-2 mt-1 cursor-pointer hover:rounded-md"},{default:a(()=>[t(V,{class:"pt-2 -mt-4"},{default:a(()=>[t(A,{id:"filter_create_date",modelValue:e(l).orderByField,"onUpdate:modelValue":[f[2]||(f[2]=b=>e(l).orderByField=b),v],label:u.$t("customers.create_date"),size:"sm",name:"filter",value:"invoices.created_at"},null,8,["modelValue","label"])]),_:1})]),_:1})]),o("div",ue,[t(P,{class:"flex px-1 cursor-pointer hover:rounded-md"},{default:a(()=>[t(V,{class:"pt-2 -mt-4"},{default:a(()=>[t(A,{id:"filter_display_name",modelValue:e(l).orderByField,"onUpdate:modelValue":[f[3]||(f[3]=b=>e(l).orderByField=b),v],label:u.$t("customers.display_name"),size:"sm",name:"filter",value:"name"},null,8,["modelValue","label"])]),_:1})]),_:1})])]),_:1}),t(I,{class:"ml-1",size:"md",variant:"gray",onClick:D},{default:a(()=>[e($)?(n(),_(m,{key:0,name:"SortAscendingIcon"})):(n(),_(m,{key:1,name:"SortDescendingIcon"}))]),_:1})])]),o("div",me,[(n(!0),B(U,null,z(e(h).customers,(b,G)=>(n(),B("div",{key:G},[b&&!e(i)?(n(),_(q,{key:0,id:"customer-"+b.id,to:`/admin/customers/${b.id}/view`,class:H(["flex justify-between p-4 items-center cursor-pointer hover:bg-gray-100 border-l-4 border-transparent",{"bg-gray-100 border-l-4 border-primary-500 border-solid":x(b.id)}]),style:{"border-top":"1px solid rgba(185, 193, 209, 0.41)"}},{default:a(()=>[o("div",null,[t(N,{text:b.name,length:30,class:"pr-2 text-sm not-italic font-normal leading-5 text-black capitalize truncate"},null,8,["text"]),b.contact_name?(n(),_(N,{key:0,text:b.contact_name,length:30,class:"mt-1 text-xs not-italic font-medium leading-5 text-gray-600"},null,8,["text"])):p("",!0)]),o("div",_e,[t(X,{amount:b.due_amount,currency:b.currency},null,8,["amount","currency"])])]),_:2},1032,["id","to","class"])):p("",!0)]))),128)),o("div",pe,[e(i)?(n(),_(ae,{key:0,class:"h-6 m-1 animate-spin text-primary-400"})):p("",!0)]),!e(h).customers.length&&!e(i)?(n(),B("p",fe,g(u.$t("customers.no_matching_customers")),1)):p("",!0)])])}}},ye={class:"pt-6 mt-5 border-t border-solid lg:pt-8 md:pt-4 border-gray-200"},ge={key:0,class:"text-sm font-bold leading-5 text-black non-italic"},xe={key:0},be={key:1},ve={key:1,class:"text-sm font-bold leading-5 text-black non-italic"},Be={setup(F){const h=M(),s=w(()=>h.selectedViewCustomer),d=w(()=>h.isFetchingViewData),r=w(()=>s?.value?.fields?s?.value?.fields:[]);return(i,l)=>{const $=c("BaseHeading"),x=c("BaseDescriptionListItem"),T=c("BaseDescriptionList"),y=c("BaseCustomerAddressDisplay");return n(),B("div",ye,[t($,null,{default:a(()=>[E(g(i.$t("customers.basic_info")),1)]),_:1}),t(T,null,{default:a(()=>[t(x,{"content-loading":e(d),label:i.$t("customers.display_name"),value:e(s)?.name},null,8,["content-loading","label","value"]),t(x,{"content-loading":e(d),label:i.$t("customers.primary_contact_name"),value:e(s)?.contact_name},null,8,["content-loading","label","value"]),t(x,{"content-loading":e(d),label:i.$t("customers.email"),value:e(s)?.email},null,8,["content-loading","label","value"])]),_:1}),t(T,{class:"mt-5"},{default:a(()=>[t(x,{"content-loading":e(d),label:i.$t("wizard.currency"),value:e(s)?.currency?`${e(s)?.currency?.code} (${e(s)?.currency?.symbol})`:""},null,8,["content-loading","label","value"]),t(x,{"content-loading":e(d),label:i.$t("customers.phone_number"),value:e(s)?.phone},null,8,["content-loading","label","value"]),t(x,{"content-loading":e(d),label:i.$t("customers.website"),value:e(s)?.website},null,8,["content-loading","label","value"]),t(x,{"content-loading":e(d),label:i.$t("customers.prefix"),value:e(s)?.prefix},null,8,["content-loading","label","value"])]),_:1}),e(s).billing||e(s).shipping?(n(),_($,{key:0,class:"mt-8"},{default:a(()=>[E(g(i.$t("customers.address")),1)]),_:1})):p("",!0),t(T,{class:"mt-5"},{default:a(()=>[e(s).billing?(n(),_(x,{key:0,"content-loading":e(d),label:i.$t("customers.billing_address")},{default:a(()=>[t(y,{address:e(s).billing},null,8,["address"])]),_:1},8,["content-loading","label"])):p("",!0),e(s).shipping?(n(),_(x,{key:1,"content-loading":e(d),label:i.$t("customers.shipping_address")},{default:a(()=>[t(y,{address:e(s).shipping},null,8,["address"])]),_:1},8,["content-loading","label"])):p("",!0)]),_:1}),e(r).length>0?(n(),_($,{key:1,class:"mt-8"},{default:a(()=>[E(g(i.$t("settings.custom_fields.title")),1)]),_:1})):p("",!0),t(T,{class:"mt-5"},{default:a(()=>[(n(!0),B(U,null,z(e(r),(v,D)=>(n(),_(x,{key:D,"content-loading":e(d),label:v.custom_field.label},{default:a(()=>[v.type==="Switch"?(n(),B("p",ge,[v.default_answer===1?(n(),B("span",xe," Yes ")):(n(),B("span",be," No "))])):(n(),B("p",ve,g(v.default_answer),1))]),_:2},1032,["content-loading","label"]))),128))]),_:1})])}}},$e={},we={class:"col-span-12 xl:col-span-9 xxl:col-span-10"},Ce={class:"flex justify-between mt-1 mb-6"},Te={class:"grid col-span-12 mt-6 text-center xl:mt-0 sm:grid-cols-4 xl:text-right xl:col-span-3 xl:grid-cols-1 xxl:col-span-2"},ke={class:"flex flex-col items-center justify-center px-6 py-2 lg:justify-end lg:items-end"},Ee={class:"flex flex-col items-center justify-center px-6 py-2 lg:justify-end lg:items-end"},Ie={class:"flex flex-col items-center justify-center px-6 py-2 lg:justify-end lg:items-end"},De={class:"flex flex-col items-center justify-center px-6 py-2 lg:justify-end lg:items-end"};function Ve(F,h){const s=c("BaseContentPlaceholdersText"),d=c("BaseContentPlaceholdersBox"),r=c("BaseContentPlaceholders");return n(),_(r,{class:"grid grid-cols-12"},{default:a(()=>[o("div",we,[o("div",Ce,[t(s,{class:"h-10 w-36",lines:1}),t(s,{class:"h-10 w-40 !mt-0",lines:1})]),t(d,{class:"h-80 xl:h-72 sm:w-full"})]),o("div",Te,[o("div",ke,[t(s,{class:"h-3 w-14 xl:h-4",lines:1}),t(s,{class:"w-20 h-5 xl:h-6",lines:1})]),o("div",Ee,[t(s,{class:"h-3 w-14 xl:h-4",lines:1}),t(s,{class:"w-20 h-5 xl:h-6",lines:1})]),o("div",Ie,[t(s,{class:"h-3 w-14 xl:h-4",lines:1}),t(s,{class:"w-20 h-5 xl:h-6",lines:1})]),o("div",De,[t(s,{class:"h-3 w-14 xl:h-4",lines:1}),t(s,{class:"w-20 h-5 xl:h-6",lines:1})])])]),_:1})}var Ae=K($e,[["render",Ve]]);const Se={key:1,class:"grid grid-cols-12"},Fe={class:"col-span-12 xl:col-span-9 xxl:col-span-10"},Pe={class:"flex justify-between mt-1 mb-6"},je={class:"flex items-center"},Re={class:"w-40 h-10"},Me={class:"grid col-span-12 mt-6 text-center xl:mt-0 sm:grid-cols-4 xl:text-right xl:col-span-3 xl:grid-cols-1 xxl:col-span-2"},Le={class:"px-6 py-2"},Ne={class:"text-xs leading-5 lg:text-sm"},Oe=o("br",null,null,-1),Ue={key:0,class:"block mt-1 text-xl font-semibold leading-8"},ze={class:"px-6 py-2"},He={class:"text-xs leading-5 lg:text-sm"},Ye=o("br",null,null,-1),Xe={key:0,class:"block mt-1 text-xl font-semibold leading-8",style:{color:"#00c99c"}},qe={class:"px-6 py-2"},Ge={class:"text-xs leading-5 lg:text-sm"},Je=o("br",null,null,-1),Ke={key:0,class:"block mt-1 text-xl font-semibold leading-8",style:{color:"#fb7178"}},Qe={class:"px-6 py-2"},We={class:"text-xs leading-5 lg:text-sm"},Ze=o("br",null,null,-1),et={key:0,class:"block mt-1 text-xl font-semibold leading-8",style:{color:"#5851d8"}},tt={setup(F){Q();const h=M();Y("utils");const s=L();let d=S(!1),r=R({}),i=R({}),l=R(["This year","Previous year"]),$=S("This year");const x=w(()=>r.expenseTotals?r.expenseTotals:[]),T=w(()=>r.netProfits?r.netProfits:[]),y=w(()=>r&&r.months?r.months:[]),v=w(()=>r.receiptTotals?r.receiptTotals:[]),D=w(()=>r.invoiceTotals?r.invoiceTotals:[]);W(s,()=>{s.params.id&&u(),$.value="This year"},{immediate:!0});async function u(){d.value=!1;let m=await h.fetchViewCustomer({id:s.params.id});m.data&&(Object.assign(r,m.data.meta.chartData),Object.assign(i,m.data.data)),d.value=!0}async function f(m){let k={id:s.params.id};m==="Previous year"?k.previous_year=!0:k.this_year=!0;let I=await h.fetchViewCustomer(k);return I.data.meta.chartData&&Object.assign(r,I.data.meta.chartData),!0}return(m,k)=>{const I=c("BaseIcon"),A=c("BaseMultiselect"),V=c("BaseFormatMoney"),P=c("BaseCard");return n(),_(P,{class:"flex flex-col mt-6"},{default:a(()=>[e(h).isFetchingViewData?(n(),_(Ae,{key:0})):(n(),B("div",Se,[o("div",Fe,[o("div",Pe,[o("h6",je,[t(I,{name:"ChartSquareBarIcon",class:"h-5 text-primary-400"}),E(" "+g(m.$t("dashboard.monthly_chart.title")),1)]),o("div",Re,[t(A,{modelValue:e($),"onUpdate:modelValue":k[0]||(k[0]=j=>Z($)?$.value=j:$=j),options:e(l),"allow-empty":!1,"show-labels":!1,placeholder:m.$t("dashboard.select_year"),"can-deselect":!1,onSelect:f},null,8,["modelValue","options","placeholder"])])]),e(d)?(n(),_(ne,{key:0,invoices:e(D),expenses:e(x),receipts:e(v),income:e(T),labels:e(y),class:"sm:w-full"},null,8,["invoices","expenses","receipts","income","labels"])):p("",!0)]),o("div",Me,[o("div",Le,[o("span",Ne,g(m.$t("dashboard.chart_info.total_sales")),1),Oe,e(d)?(n(),B("span",Ue,[t(V,{amount:e(r).salesTotal,currency:e(i).currency},null,8,["amount","currency"])])):p("",!0)]),o("div",ze,[o("span",He,g(m.$t("dashboard.chart_info.total_receipts")),1),Ye,e(d)?(n(),B("span",Xe,[t(V,{amount:e(r).totalExpenses,currency:e(i).currency},null,8,["amount","currency"])])):p("",!0)]),o("div",qe,[o("span",Ge,g(m.$t("dashboard.chart_info.total_expense")),1),Je,e(d)?(n(),B("span",Ke,[t(V,{amount:e(r).totalExpenses,currency:e(i).currency},null,8,["amount","currency"])])):p("",!0)]),o("div",Qe,[o("span",We,g(m.$t("dashboard.chart_info.net_income")),1),Ze,e(d)?(n(),B("span",et,[t(V,{amount:e(r).netProfit,currency:e(i).currency},null,8,["amount","currency"])])):p("",!0)])])])),t(Be)]),_:1})}}},rt={setup(F){Y("utils"),ee();const h=M(),s=te();O();const d=se(),r=L();S(null);const i=w(()=>h.selectedViewCustomer.customer?h.selectedViewCustomer.customer.name:"");let l=w(()=>h.isFetchingViewData);function $(){return s.hasAbilities([C.CREATE_ESTIMATE,C.CREATE_INVOICE,C.CREATE_PAYMENT,C.CREATE_EXPENSE])}function x(){return s.hasAbilities([C.DELETE_CUSTOMER,C.EDIT_CUSTOMER])}function T(){d.push("/admin/customers")}return(y,v)=>{const D=c("BaseButton"),u=c("router-link"),f=c("BaseIcon"),m=c("BaseDropdownItem"),k=c("BaseDropdown"),I=c("BasePageHeader"),A=c("BasePage");return n(),_(A,{class:"xl:pl-96"},{default:a(()=>[t(I,{title:e(i)},{actions:a(()=>[e(s).hasAbilities(e(C).EDIT_CUSTOMER)?(n(),_(u,{key:0,to:`/admin/customers/${e(r).params.id}/edit`},{default:a(()=>[t(D,{class:"mr-3",variant:"primary-outline","content-loading":e(l)},{default:a(()=>[E(g(y.$t("general.edit")),1)]),_:1},8,["content-loading"])]),_:1},8,["to"])):p("",!0),$()?(n(),_(k,{key:1,position:"bottom-end","content-loading":e(l)},{activator:a(()=>[t(D,{class:"mr-3",variant:"primary","content-loading":e(l)},{default:a(()=>[E(g(y.$t("customers.new_transaction")),1)]),_:1},8,["content-loading"])]),default:a(()=>[e(s).hasAbilities(e(C).CREATE_ESTIMATE)?(n(),_(u,{key:0,to:`/admin/estimates/create?customer=${y.$route.params.id}`},{default:a(()=>[t(m,{class:""},{default:a(()=>[t(f,{name:"DocumentIcon",class:"mr-3 text-gray-600"}),E(" "+g(y.$t("estimates.new_estimate")),1)]),_:1})]),_:1},8,["to"])):p("",!0),e(s).hasAbilities(e(C).CREATE_INVOICE)?(n(),_(u,{key:1,to:`/admin/invoices/create?customer=${y.$route.params.id}`},{default:a(()=>[t(m,null,{default:a(()=>[t(f,{name:"DocumentTextIcon",class:"mr-3 text-gray-600"}),E(" "+g(y.$t("invoices.new_invoice")),1)]),_:1})]),_:1},8,["to"])):p("",!0),e(s).hasAbilities(e(C).CREATE_PAYMENT)?(n(),_(u,{key:2,to:`/admin/payments/create?customer=${y.$route.params.id}`},{default:a(()=>[t(m,null,{default:a(()=>[t(f,{name:"CreditCardIcon",class:"mr-3 text-gray-600"}),E(" "+g(y.$t("payments.new_payment")),1)]),_:1})]),_:1},8,["to"])):p("",!0),e(s).hasAbilities(e(C).CREATE_EXPENSE)?(n(),_(u,{key:3,to:`/admin/expenses/create?customer=${y.$route.params.id}`},{default:a(()=>[t(m,null,{default:a(()=>[t(f,{name:"CalculatorIcon",class:"mr-3 text-gray-600"}),E(" "+g(y.$t("expenses.new_expense")),1)]),_:1})]),_:1},8,["to"])):p("",!0)]),_:1},8,["content-loading"])):p("",!0),x()?(n(),_(oe,{key:2,class:H({"ml-3":e(l)}),row:e(h).selectedViewCustomer,"load-data":T},null,8,["class","row"])):p("",!0)]),_:1},8,["title"]),t(he),t(tt)]),_:1})}}};export{rt as default};
