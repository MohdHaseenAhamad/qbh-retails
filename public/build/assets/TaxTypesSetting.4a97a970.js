import{R,u as U,e as $,av as Y,x as j,I as z,Q as M,F as O,r as l,o as m,n as g,w as e,m as a,a as n,J as x,q as T,t as B,U as I,H,g as A,l as N,L as P,E as q,c as J,p as Q}from"./main.d0ffa6eb.js";import{_ as G}from"./TaxTypeModal.fd62b2ec.js";const K={props:{row:{type:Object,default:null},table:{type:Object,default:null},loadData:{type:Function,default:null}},setup(S){const s=S,b=R();U();const{t:i}=$(),h=Y(),C=j(),_=z(),c=M();O("utils");async function D(r){await h.fetchTaxType(r),c.openModal({title:i("settings.tax_types.edit_tax"),componentName:"TaxTypeModal",size:"sm",refreshData:s.loadData&&s.loadData})}function w(r){b.openDialog({title:i("general.are_you_sure"),message:i("settings.tax_types.confirm_delete"),yesLabel:i("general.ok"),noLabel:i("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async d=>{if(d){if((await h.deleteTaxType(r)).data.success)return s.loadData&&s.loadData(),!0;s.loadData&&s.loadData()}})}return(r,d)=>{const p=l("BaseIcon"),E=l("BaseButton"),v=l("BaseDropdownItem"),t=l("BaseDropdown");return m(),g(t,null,{activator:e(()=>[a(C).name==="tax-types.view"?(m(),g(E,{key:0,variant:"primary"},{default:e(()=>[n(p,{name:"DotsHorizontalIcon",class:"h-5 text-white"})]),_:1})):(m(),g(p,{key:1,name:"DotsHorizontalIcon",class:"h-5 text-gray-500"}))]),default:e(()=>[a(_).hasAbilities(a(x).EDIT_TAX_TYPE)?(m(),g(v,{key:0,onClick:d[0]||(d[0]=u=>D(S.row.id))},{default:e(()=>[n(p,{name:"PencilIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),T(" "+B(r.$t("general.edit")),1)]),_:1})):I("",!0),a(_).hasAbilities(a(x).DELETE_TAX_TYPE)?(m(),g(v,{key:1,onClick:d[1]||(d[1]=u=>w(S.row.id))},{default:e(()=>[n(p,{name:"TrashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),T(" "+B(r.$t("general.delete")),1)]),_:1})):I("",!0)]),_:1})}}},W={key:0},te={setup(S){const{t:s}=$(),b=O("utils"),i=H(),h=Y(),C=M(),_=z(),c=A(null),D=A(i.selectedCompanySettings.tax_per_item),w=N(()=>[{key:"name",label:s("settings.tax_types.tax_name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"compound_tax",label:s("settings.tax_types.compound_tax"),tdClass:"font-medium text-gray-900"},{key:"percent",label:s("settings.tax_types.percent"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"actions",label:"",tdClass:"text-right text-sm font-medium",sortable:!1}]),r=N({get:()=>D.value==="YES",set:async t=>{const u=t?"YES":"NO";let y={settings:{tax_per_item:u}};D.value=u,await i.updateCompanySettings({data:y,message:"general.setting_updated"})}});function d(){return _.hasAbilities([x.DELETE_TAX_TYPE,x.EDIT_TAX_TYPE])}async function p({page:t,filter:u,sort:y}){let k={orderByField:y.fieldName||"created_at",orderBy:y.order||"desc",page:t},f=await h.fetchTaxTypes(k);return{data:f.data.data,pagination:{totalPages:f.data.meta.last_page,currentPage:t,totalCount:f.data.meta.total,limit:5}}}async function E(){c.value&&c.value.refresh()}function v(){C.openModal({title:s("settings.tax_types.add_tax"),componentName:"TaxTypeModal",size:"sm",refreshData:c.value&&c.value.refresh})}return(t,u)=>{const y=l("BaseIcon"),k=l("BaseButton"),f=l("BaseBadge"),V=l("BaseTable"),L=l("BaseDivider"),X=l("BaseSwitchSection"),F=l("BaseSettingCard");return m(),g(F,{title:t.$t("settings.tax_types.title"),description:t.$t("settings.tax_types.description")},P({default:e(()=>[n(G),n(V,{ref_key:"table",ref:c,class:"mt-16",data:p,columns:a(w)},P({"cell-compound_tax":e(({row:o})=>[n(f,{"bg-color":a(b).getBadgeStatusColor(o.data.compound_tax?"YES":"NO").bgColor,color:a(b).getBadgeStatusColor(o.data.compound_tax?"YES":"NO").color},{default:e(()=>[T(B(o.data.compound_tax?"Yes":"No".replace("_"," ")),1)]),_:2},1032,["bg-color","color"])]),"cell-percent":e(({row:o})=>[T(B(o.data.percent)+" % ",1)]),_:2},[d()?{name:"cell-actions",fn:e(({row:o})=>[n(K,{row:o.data,table:c.value,"load-data":E},null,8,["row","table"])])}:void 0]),1032,["columns"]),a(_).currentUser.is_owner?(m(),J("div",W,[n(L,{class:"mt-8 mb-2"}),n(X,{modelValue:a(r),"onUpdate:modelValue":u[0]||(u[0]=o=>Q(r)?r.value=o:null),title:t.$t("settings.tax_types.tax_per_item"),description:t.$t("settings.tax_types.tax_setting_description")},null,8,["modelValue","title","description"])])):I("",!0)]),_:2},[a(_).hasAbilities(a(x).CREATE_TAX_TYPE)?{name:"action",fn:e(()=>[n(k,{type:"submit",variant:"primary-outline",onClick:v},{left:e(o=>[n(y,{class:q(o.class),name:"PlusIcon"},null,8,["class"])]),default:e(()=>[T(" "+B(t.$t("settings.tax_types.add_new_tax")),1)]),_:1})])}:void 0]),1032,["title","description"])}}};export{te as default};
