import{Q as Y,V as Z,u as ee,R as te,I as ae,e as se,F as oe,g as d,x as le,f as re,y as ne,l as x,K as ie,ab as de,r as n,o as u,c as h,a,n as p,w as l,m as o,J as ue,q as $,t as _,U as y,b as i,aa as D,a9 as ce,E as me}from"./main.d0ffa6eb.js";import{_ as fe}from"./EstimateIndexDropdown.943ccd60.js";import{_ as pe}from"./SendEstimateModal.05295d41.js";import{L as _e}from"./LoadingIcon.272413e7.js";const ye={class:"fixed top-0 left-0 hidden h-full pt-16 pb-4 ml-56 bg-white xl:ml-64 w-88 xl:block"},be={class:"flex items-center justify-between px-4 pt-8 pb-2 border border-gray-200 border-solid height-full"},ge={class:"mb-6"},xe={class:"flex mb-6 ml-3",role:"group","aria-label":"First group"},he={class:"px-4 py-1 pb-2 mb-1 mb-2 text-sm border-b border-gray-200 border-solid"},ve={key:0,class:"h-full pb-32 overflow-y-scroll border-l border-gray-200 border-solid base-scroll"},Be={class:"flex-2"},Ee={class:"mt-1 mb-2 text-xs not-italic font-medium leading-5 text-gray-600"},we={class:"flex-1 whitespace-nowrap right"},Se={class:"text-sm not-italic font-normal leading-5 text-right text-gray-600 est-date"},ke={class:"flex justify-center p-4 items-center"},Ie={key:0,class:"flex justify-center px-4 mt-5 text-sm text-gray-600"},Te={class:"flex flex-col min-h-0 mt-8 overflow-hidden",style:{height:"75vh"}},Fe=["src"],Ne={setup(Ve){const C=Y(),m=Z();ee(),te();const R=ae(),{t:B}=se();oe("$utils"),d(null),d(null);const c=d(null);d(null);const b=le();re(),d(["DRAFT","SENT","VIEWED","EXPIRED","ACCEPTED","REJECTED"]),d(!1);const N=d(!1);d(!1);const T=d(!1),g=d(!1),E=d(!1),t=ne({orderBy:null,orderByField:null,searchText:null}),z=x(()=>c.value.estimate_number),F=x(()=>t.orderBy==="asc"||t.orderBy==null);x(()=>F.value?B("general.ascending"):B("general.descending"));const A=x(()=>`/estimates/pdf/${c.value.unique_hash}`);x(()=>c.value&&c.value.id?estimate.value.id:null),ie(b,(e,r)=>{e.name==="estimates.view"&&V()}),U(),V(),f=de.exports.debounce(f,500);function L(e){return b.params.id==e}async function U(){g.value=!0,await m.fetchEstimates(b.params.id),g.value=!1,setTimeout(()=>{M()},500)}function M(){const e=document.getElementById(`estimate-${b.params.id}`);e&&(e.scrollIntoView({behavior:"smooth"}),e.classList.add("shake"))}async function V(){E.value=!0;let e=await m.fetchEstimate(b.params.id);e.data&&(E.value=!1,c.value={...e.data.data})}async function f(){let e="";t.searchText!==""&&t.searchText!==null&&t.searchText!==void 0&&(e+=`search=${t.searchText}&`),t.orderBy!==null&&t.orderBy!==void 0&&(e+=`orderBy=${t.orderBy}&`),t.orderByField!==null&&t.orderByField!==void 0&&(e+=`orderByField=${t.orderByField}`),T.value=!0;let r=await m.searchEstimate(e);T.value=!1,r.data&&(m.estimates=r.data.data)}function P(){return t.orderBy==="asc"?(t.orderBy="desc",f(),!0):(t.orderBy="asc",f(),!0)}async function j(e){C.openModal({title:B("estimates.send_estimate"),componentName:"SendEstimateModal",id:c.value.id,data:c.value})}return(e,r)=>{const w=n("BaseButton"),q=n("BasePageHeader"),v=n("BaseIcon"),G=n("BaseInput"),S=n("BaseRadio"),k=n("BaseInputGroup"),I=n("BaseDropdownItem"),H=n("BaseDropdown"),J=n("BaseText"),K=n("BaseEstimateStatusBadge"),O=n("BaseFormatMoney"),Q=n("router-link"),W=n("BasePage");return u(),h(D,null,[a(pe),c.value?(u(),p(W,{key:0,class:"xl:pl-96 xl:ml-8"},{default:l(()=>[a(q,{title:o(z)},{actions:l(()=>[c.value.status==="DRAFT"&&o(R).hasAbilities(o(ue).SEND_ESTIMATE)?(u(),p(w,{key:0,disabled:N.value,"content-loading":E.value,variant:"primary",class:"text-sm",onClick:j},{default:l(()=>[$(_(e.$t("estimates.send_estimate")),1)]),_:1},8,["disabled","content-loading"])):y("",!0),a(fe,{class:"ml-3",row:c.value},null,8,["row"])]),_:1},8,["title"]),i("div",ye,[i("div",be,[i("div",ge,[a(G,{modelValue:o(t).searchText,"onUpdate:modelValue":r[0]||(r[0]=s=>o(t).searchText=s),placeholder:e.$t("general.search"),type:"text",variant:"gray",onInput:r[1]||(r[1]=s=>f())},{right:l(()=>[a(v,{name:"SearchIcon",class:"text-gray-400"})]),_:1},8,["modelValue","placeholder"])]),i("div",xe,[a(H,{class:"ml-3",position:"bottom-start","width-class":"w-45","position-class":"left-0"},{activator:l(()=>[a(w,{size:"md",variant:"gray"},{default:l(()=>[a(v,{name:"FilterIcon"})]),_:1})]),default:l(()=>[i("div",he,_(e.$t("general.sort_by")),1),a(I,{class:"flex px-4 py-2 cursor-pointer"},{default:l(()=>[a(k,{class:"-mt-3 font-normal"},{default:l(()=>[a(S,{id:"filter_estimate_date",modelValue:o(t).orderByField,"onUpdate:modelValue":[r[2]||(r[2]=s=>o(t).orderByField=s),f],label:e.$t("reports.estimates.estimate_date"),size:"sm",name:"filter",value:"estimate_date"},null,8,["modelValue","label"])]),_:1})]),_:1}),a(I,{class:"flex px-4 py-2 cursor-pointer"},{default:l(()=>[a(k,{class:"-mt-3 font-normal"},{default:l(()=>[a(S,{id:"filter_due_date",modelValue:o(t).orderByField,"onUpdate:modelValue":[r[3]||(r[3]=s=>o(t).orderByField=s),f],label:e.$t("estimates.due_date"),value:"expiry_date",size:"sm",name:"filter"},null,8,["modelValue","label"])]),_:1})]),_:1}),a(I,{class:"flex px-4 py-2 cursor-pointer"},{default:l(()=>[a(k,{class:"-mt-3 font-normal"},{default:l(()=>[a(S,{id:"filter_estimate_number",modelValue:o(t).orderByField,"onUpdate:modelValue":[r[4]||(r[4]=s=>o(t).orderByField=s),f],label:e.$t("estimates.estimate_number"),value:"estimate_number",size:"sm",name:"filter"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),a(w,{class:"ml-1",size:"md",variant:"gray",onClick:P},{default:l(()=>[o(F)?(u(),p(v,{key:0,name:"SortAscendingIcon"})):(u(),p(v,{key:1,name:"SortDescendingIcon"}))]),_:1})])]),o(m)&&o(m).estimates?(u(),h("div",ve,[(u(!0),h(D,null,ce(o(m).estimates,(s,X)=>(u(),h("div",{key:X},[s&&!g.value?(u(),p(Q,{key:0,id:"estimate-"+s.id,to:`/admin/estimates/${s.id}/view`,class:me(["flex justify-between side-estimate p-4 cursor-pointer hover:bg-gray-100 items-center border-l-4 border-transparent",{"bg-gray-100 border-l-4 border-primary-500 border-solid":L(s.id)}]),style:{"border-bottom":"1px solid rgba(185, 193, 209, 0.41)"}},{default:l(()=>[i("div",Be,[a(J,{text:s.customer.name,length:30,class:"pr-2 mb-2 text-sm not-italic font-normal leading-5 text-black capitalize truncate"},null,8,["text"]),i("div",Ee,_(s.estimate_number),1),a(K,{status:s.status,class:"px-1 text-xs"},{default:l(()=>[$(_(s.status),1)]),_:2},1032,["status"])]),i("div",we,[a(O,{amount:s.total,currency:s.customer.currency,class:"block mb-2 text-xl not-italic font-semibold leading-8 text-right text-gray-900"},null,8,["amount","currency"]),i("div",Se,_(s.formatted_estimate_date),1)])]),_:2},1032,["id","to","class"])):y("",!0)]))),128)),i("div",ke,[g.value?(u(),p(_e,{key:0,class:"h-6 m-1 animate-spin text-primary-400"})):y("",!0)]),!o(m).estimates.length&&!g.value?(u(),h("p",Ie,_(e.$t("estimates.no_matching_estimates")),1)):y("",!0)])):y("",!0)]),i("div",Te,[i("iframe",{src:`${o(A)}`,class:"flex-1 border border-gray-400 border-solid rounded-md bg-white frame-style"},null,8,Fe)])]),_:1})):y("",!0)],64)}}};export{Ne as default};
