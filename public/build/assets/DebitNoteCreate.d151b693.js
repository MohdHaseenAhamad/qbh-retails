import{aq as M,r,o as w,c as N,a as n,w as i,m as a,H as Q,a1 as W,ao as X,e as Y,x as Z,f as x,g as F,l as _,h as P,i as B,a4 as ee,a5 as ae,aP as ne,k as te,K as oe,b as V,n as $,t as S,U as q,E as L,q as G,s as le,aa as ie}from"./main.d0ffa6eb.js";import{_ as se,a as de,b as re,c as ue,d as ce}from"./ItemModal.720790e2.js";import{_ as me}from"./SelectTemplateButton.5704c8fd.js";import{_ as ge}from"./ExchangeRateConverter.ef383681.js";import{_ as be}from"./TaxTypeModal.fd62b2ec.js";import{_ as pe}from"./PreparedByModal.fa78cd8f.js";import"./DragIcon.e0a4ab5f.js";import"./ItemUnitModal.dc6156ec.js";import"./SelectNotePopup.f61bb6cc.js";import"./NoteModal.688693f3.js";/* empty css                                                  */const fe={class:"grid grid-cols-12 gap-8 mt-6 mb-8"},he={props:{v:{type:Object,default:null},isLoading:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1}},setup(t){const e=M();return(u,o)=>{const c=r("BaseCustomerSelectPopup"),d=r("BaseInputGroup"),g=r("BaseInput"),b=r("BaseDatePicker"),m=r("BaseInputGrid");return w(),N("div",fe,[n(m,{class:"col-span-12 sm:grid-cols-4 md:grid-cols-4"},{default:i(()=>[n(d,{label:u.$t("debits.supplier"),"content-loading":t.isLoading,required:""},{default:i(()=>[n(c,{modelValue:a(e).newPurchase.customer,"onUpdate:modelValue":o[0]||(o[0]=l=>a(e).newPurchase.customer=l),valid:t.v.customer_id,"content-loading":t.isLoading,type:"debit",class:"col-span-12 lg:col-span-5 pr-0"},null,8,["modelValue","valid","content-loading"])]),_:1},8,["label","content-loading"]),n(d,{label:u.$t("debits.number"),"content-loading":t.isLoading,error:t.v.debit_number.$error&&t.v.debit_number.$errors[0].$message,required:""},{default:i(()=>[n(g,{disabled:"",modelValue:a(e).newPurchase.debit_number,"onUpdate:modelValue":o[1]||(o[1]=l=>a(e).newPurchase.debit_number=l),"content-loading":t.isLoading,onInput:o[2]||(o[2]=l=>t.v.debit_number.$touch())},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading","error"]),n(d,{label:u.$t("debits.date"),"content-loading":t.isLoading,required:"",error:t.v.debit_date.$error&&t.v.debit_date.$errors[0].$message},{default:i(()=>[n(b,{disabled:"",modelValue:a(e).newPurchase.debit_date,"onUpdate:modelValue":o[3]||(o[3]=l=>a(e).newPurchase.debit_date=l),"content-loading":t.isLoading,"calendar-button":!0,"calendar-button-icon":"calendar",enableTime:"true",time24hr:"true"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading","error"]),n(d,{label:u.$t("purchases.reference_number"),"content-loading":t.isLoading},{default:i(()=>[n(g,{modelValue:a(e).newPurchase.reference_number,"onUpdate:modelValue":o[4]||(o[4]=l=>a(e).newPurchase.reference_number=l),"content-loading":t.isLoading,disabled:a(e).newPurchase.is_edit?a(e).newPurchase.is_edit!="1":!1},null,8,["modelValue","content-loading","disabled"])]),_:1},8,["label","content-loading"]),n(d,{label:u.$t("debits.reason"),"content-loading":t.isLoading},{default:i(()=>[n(g,{modelValue:a(e).newPurchase.reason,"onUpdate:modelValue":o[5]||(o[5]=l=>a(e).newPurchase.reason=l),"content-loading":t.isLoading,disabled:a(e).newPurchase.is_edit?a(e).newPurchase.is_edit!="1":!1},null,8,["modelValue","content-loading","disabled"])]),_:1},8,["label","content-loading"]),n(d,{label:u.$t("purchases.number"),"content-loading":t.isLoading,required:""},{default:i(()=>[n(g,{disabled:"",modelValue:a(e).newPurchase.purchase_no,"onUpdate:modelValue":o[6]||(o[6]=l=>a(e).newPurchase.purchase_no=l),"content-loading":t.isLoading},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),n(d,{label:u.$t("purchases.date"),"content-loading":t.isLoading,required:""},{default:i(()=>[n(b,{disabled:"",modelValue:a(e).newPurchase.purchase_date,"onUpdate:modelValue":o[7]||(o[7]=l=>a(e).newPurchase.purchase_date=l),"content-loading":t.isLoading,"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),n(d,{label:u.$t("purchases.invoice_no"),"content-loading":t.isLoading,required:""},{default:i(()=>[n(g,{disabled:"",modelValue:a(e).newPurchase.invoice_no,"onUpdate:modelValue":o[8]||(o[8]=l=>a(e).newPurchase.invoice_no=l),"content-loading":t.isLoading},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),n(d,{label:u.$t("purchases.invoice_date"),"content-loading":t.isLoading,required:""},{default:i(()=>[n(b,{disabled:"",modelValue:a(e).newPurchase.invoice_date,"onUpdate:modelValue":o[9]||(o[9]=l=>a(e).newPurchase.invoice_date=l),"content-loading":t.isLoading,"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),n(d,{label:u.$t("purchases.order_no"),"content-loading":t.isLoading},{default:i(()=>[n(g,{disabled:"",modelValue:a(e).newPurchase.order_no,"onUpdate:modelValue":o[10]||(o[10]=l=>a(e).newPurchase.order_no=l),"content-loading":t.isLoading},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),n(d,{label:u.$t("purchases.order_date"),"content-loading":t.isLoading},{default:i(()=>[n(b,{disabled:"",modelValue:a(e).newPurchase.order_date,"onUpdate:modelValue":o[11]||(o[11]=l=>a(e).newPurchase.order_date=l),"content-loading":t.isLoading,"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),n(d,{label:u.$t("purchases.material_receipt_no"),"content-loading":t.isLoading},{default:i(()=>[n(g,{disabled:"",modelValue:a(e).newPurchase.material_receipt,"onUpdate:modelValue":o[12]||(o[12]=l=>a(e).newPurchase.material_receipt=l),"content-loading":t.isLoading},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),n(d,{label:u.$t("purchases.supply_date"),"content-loading":t.isLoading},{default:i(()=>[n(b,{disabled:"",modelValue:a(e).newPurchase.supply_date,"onUpdate:modelValue":o[13]||(o[13]=l=>a(e).newPurchase.supply_date=l),"content-loading":t.isLoading,"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),n(ge,{store:a(e),"store-prop":"newPurchase",v:t.v,"is-loading":t.isLoading,"is-edit":t.isEdit,"customer-currency":a(e).newPurchase.currency_id},null,8,["store","v","is-loading","is-edit","customer-currency"])]),_:1})])}}},we=["onSubmit"],ve={class:"flex"},Pe={class:"block mt-10 invoice-foot lg:flex lg:justify-between lg:items-start"},_e={class:"relative w-full lg:w-1/2 lg:mr-4"},$e=V("br",null,null,-1),Fe={setup(t){const e=M(),u=Q(),o=W();X();const{t:c}=Y();let d=Z(),g=x();const b="newPurchase";let m=F(!1);const l=_(()=>e.newPurchase.is_edit==1),T=F(["customer","company","customerCustom","invoice","invoiceCustom"]);let p=_(()=>e.isFetchingInvoice||e.isFetchingInitialSettings),E=_(()=>C.value?c("debitnote.edit"):c("debitnote.create")),C=_(()=>d.name==="debit.edit");const H={debit_date:{required:P.withMessage(c("validation.required"),B)},debit_number:{required:P.withMessage(c("validation.required"),B)},reference_number:{maxLength:P.withMessage(c("validation.price_maxlength"),ee(255))},customer_id:{required:P.withMessage(c("validation.required"),B)},exchange_rate:{required:ae(function(){return P.withMessage(c("validation.required"),B),e.showExchangeRate}),decimal:P.withMessage(c("validation.valid_exchange_rate"),ne)}},y=te(H,_(()=>e.newPurchase),{$scope:b});o.resetCustomFields(),y.value.$reset,e.resetCurrentPurchase(),e.fetchPurchaseInitialSettings(!0),oe(()=>e.newPurchase.customer,s=>{s&&s.currency?e.newPurchase.selectedCurrency=s.currency:e.newPurchase.selectedCurrency=u.selectedCompanyCurrency});async function R(){if(y.value.$touch(),y.value.$invalid)return!1;m.value=!0;let s={...e.newPurchase,sub_total:e.getSubTotal,total:e.getTotal,tax:e.getTotalTax};try{const v=await(d.name=="debit.edit"?e.updateDebitNote:e.addDebitNote)(s);g.push(`/admin/debit-note/${v.data.data.id}/view`)}catch(f){console.error(f)}m.value=!1}return(s,f)=>{const v=r("BaseBreadcrumbItem"),j=r("BaseBreadcrumb"),I=r("BaseButton"),z=r("router-link"),U=r("BaseIcon"),K=r("BasePageHeader"),k=r("BaseInput"),D=r("BaseInputGroup"),O=r("BaseInputGrid"),A=r("BaseScrollPane"),J=r("BasePage");return w(),N(ie,null,[n(se),n(de),n(pe),n(be),n(J,{class:"relative invoice-create-page"},{default:i(()=>[V("form",{onSubmit:le(R,["prevent"])},[n(K,{title:a(E)},{actions:i(()=>[s.$route.name==="debit.edit"?(w(),$(z,{key:0,to:`/debits/pdf/${a(e).newPurchase.unique_hash}`,target:"_blank"},{default:i(()=>[n(I,{class:"mr-3",variant:"primary-outline",type:"button"},{default:i(()=>[V("span",ve,S(s.$t("general.view_pdf")),1)]),_:1})]),_:1},8,["to"])):q("",!0),n(I,{loading:a(m),disabled:a(m),variant:"primary",type:"submit"},{left:i(h=>[a(m)?q("",!0):(w(),$(U,{key:0,name:"SaveIcon",class:L(h.class)},null,8,["class"]))]),default:i(()=>[G(" "+S(s.$t("debitnote.save")),1)]),_:1},8,["loading","disabled"])]),default:i(()=>[n(j,null,{default:i(()=>[n(v,{title:s.$t("general.home"),to:"/admin/dashboard"},null,8,["title"]),n(v,{title:s.$tc("debitnote.debitnotes",2),to:"/admin/debit-note"},null,8,["title"]),s.$route.name==="purchases.edit"?(w(),$(v,{key:0,title:s.$t("debitnote.edit"),to:"#",active:""},null,8,["title"])):(w(),$(v,{key:1,title:s.$t("debitnote.new"),to:"#",active:""},null,8,["title"]))]),_:1})]),_:1},8,["title"]),n(he,{v:a(y),"is-loading":a(p),"is-edit":a(C)},null,8,["v","is-loading","is-edit"]),n(A,null,{default:i(()=>[n(re,{currency:a(e).newPurchase.selectedCurrency,"is-loading":a(p),"item-validation-scope":b,store:a(e),"store-prop":"newPurchase","is-draft-mode":a(l)},null,8,["currency","is-loading","store","is-draft-mode"]),V("div",Pe,[V("div",_e,[n(ue,{store:a(e),"store-prop":"newPurchase",fields:T.value,type:"Debit",class:L(a(e).newPurchase.is_edit?a(e).newPurchase.is_edit=="1"?"":"disable":"")},null,8,["store","fields","class"])]),n(ce,{currency:a(e).newPurchase.selectedCurrency,"is-loading":a(p),store:a(e),"store-prop":"newPurchase","tax-popup-type":"invoice",class:L(a(e).newPurchase.is_edit?a(e).newPurchase.is_edit=="1"?"":"disable":"")},null,8,["currency","is-loading","store","class"])]),n(O,{class:"sm:grid-cols-4 md:grid-cols-4 col-span-12 mb-4"},{default:i(()=>[n(me,{store:a(e),"store-prop":"newPurchase","component-name":"InvoiceTemplate"},null,8,["store"]),n(D,{label:s.$t("invoices.upper_margin"),"content-loading":a(p)},{default:i(()=>[n(k,{modelValue:a(e).newPurchase.upper_margin,"onUpdate:modelValue":f[0]||(f[0]=h=>a(e).newPurchase.upper_margin=h),"content-loading":a(p)},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),n(D,{label:s.$t("invoices.lower_margin"),"content-loading":a(p)},{default:i(()=>[n(k,{modelValue:a(e).newPurchase.lower_margin,"onUpdate:modelValue":f[1]||(f[1]=h=>a(e).newPurchase.lower_margin=h),"content-loading":a(p)},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"])]),_:1}),$e,n(I,{loading:a(m),disabled:a(m),variant:"primary",type:"submit"},{left:i(h=>[a(m)?q("",!0):(w(),$(U,{key:0,name:"SaveIcon",class:L(h.class)},null,8,["class"]))]),default:i(()=>[G(" "+S(s.$t("debitnote.save")),1)]),_:1},8,["loading","disabled"])]),_:1})],40,we)]),_:1})],64)}}};export{Fe as default};
