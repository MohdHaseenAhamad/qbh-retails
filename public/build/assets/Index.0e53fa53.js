import{al as de,R as me,u as pe,H as _e,e as fe,F as he,g as h,f as be,I as ve,y as ye,l as S,Y as ge,Z as Be,r as n,o as b,n as v,w as a,a as t,S as E,T as V,m as l,E as g,q as _,t as d,J as f,U as A,b as m,L as M,p as Ce}from"./main.d0ffa6eb.js";import{M as Ie}from"./MoonwalkerIcon.ec6772d4.js";import{_ as ke}from"./PurchaseIndexDropdown.94937fe6.js";import{_ as Ee}from"./SendInvoiceModal.67cc3524.js";const Ve=m("div",{class:"hidden w-8 h-0 mx-4 border border-gray-400 border-solid xl:block",style:{"margin-top":"1.5rem"}},null,-1),$e={class:"pt-6"},Pe={class:"flex"},De={class:"relative table-container"},Te={class:"relative flex items-center justify-between h-10 mt-5 list-none border-b-2 border-gray-200 border-solid"},Se={class:"flex text-sm font-medium cursor-pointer select-none text-primary-400"},Ae={class:"absolute items-center left-6 top-2.5 select-none"},we={class:"relative block"},Fe={class:"flex justify-between"},Le={setup(Ne){const c=de(),W=me();pe();const G=_e(),{t:u}=fe();he("$utils");const B=h(null),y=h(!1);h([{label:"Status",options:["DRAFT","DUE","SENT","VIEWED","OVERDUE","COMPLETED"]},{label:"Paid Status",options:["UNPAID","PAID","PARTIALLY_PAID"]},,]);const w=h(!0),F=h(!0),$=h("general.draft");be();const C=ve();let o=ye({supplier_id:"",status:"DRAFT",from_date:"",to_date:"",purchase_no:""});const N=S(()=>!c.purchaseTotalCount&&!w.value),P=S({get:()=>c.selectedPurchases,set:s=>c.selectPurchase(s)}),H=S(()=>[{key:"checkbox",thClass:"extra w-10",tdClass:"font-medium text-gray-900",placeholderClass:"w-10",sortable:!1},{key:"invoice_date",label:u("purchases.date"),thClass:"extra",tdClass:"font-medium"},{key:"invoice_number",label:u("purchases.voucher_number")},{key:"name",label:u("purchases.supplier")},{key:"status",label:u("invoices.status")},{key:"invoice_no",label:u("purchases.invoice_no")},{key:"invoice_date",label:u("purchases.invoice_date")},{key:"total",label:u("invoices.total"),tdClass:"font-medium text-gray-900"},{key:"actions",label:u("invoices.action"),tdClass:"text-right text-sm font-medium",thClass:"text-right",sortable:!1}]);ge(o,()=>{Y()},{debounce:500}),Be(()=>{c.selectAllField&&c.selectAllPurchases()});function j(){return C.hasAbilities([f.DELETE_INVOICE,f.EDIT_INVOICE,f.VIEW_INVOICE,f.SEND_INVOICE])}function x(){B.value&&B.value.refresh()}async function q({page:s,filter:r,sort:p}){let D={supplier_id:o.supplier_id,status:o.status,from_date:o.from_date,to_date:o.to_date,purchase_no:o.purchase_no,orderByField:p.fieldName||"created_at",orderBy:p.order||"desc",page:s};w.value=!0;let i=await c.fetchPurchases(D);return console.log(i),F.value=i.data.data.length>0,{data:i.data.data,pagination:{totalPages:i.data.meta.last_page,currentPage:s,totalCount:i.data.meta.total,limit:10}}}function z(s){if($.value==s.title)return!0;switch($.value=s.title,s.title){case u("general.draft"):o.status="DRAFT";break;case u("general.sent"):o.status="SENT";break;case u("general.due"):o.status="DUE";break;default:o.status="";break}}function Y(){c.$patch(s=>{s.selectedPurchases=[],s.selectAllField=!1}),x()}function U(){o.supplier_id="",o.status="",o.from_date="",o.to_date="",o.purchase_no="",$.value=u("general.all")}async function J(){W.openDialog({title:u("general.are_you_sure"),message:u("purchases.confirm_delete"),yesLabel:u("general.ok"),noLabel:u("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async s=>{s&&await c.deleteMultiplePurchases().then(r=>{r.data.success&&(x(),c.$patch(p=>{p.selectedPurchases=[],p.selectAllField=!1}))})})}function X(){y.value&&U(),y.value=!y.value}return(s,r)=>{const p=n("BaseBreadcrumbItem"),D=n("BaseBreadcrumb"),i=n("BaseIcon"),I=n("BaseButton"),T=n("router-link"),Z=n("BasePageHeader"),K=n("BaseCustomerSelectInput"),k=n("BaseInputGroup"),O=n("BaseDatePicker"),Q=n("BaseInput"),ee=n("BaseFilterWrapper"),te=n("BaseEmptyPlaceholder"),ae=n("BaseTab"),se=n("BaseTabGroup"),le=n("BaseDropdownItem"),oe=n("BaseDropdown"),R=n("BaseCheckbox"),ne=n("BaseText"),L=n("BaseFormatMoney"),re=n("BasePaidStatusBadge"),ue=n("BaseTable"),ce=n("BasePage");return b(),v(ce,null,{default:a(()=>[t(Ee),t(Z,{title:s.$t("purchases.title")},{actions:a(()=>[E(t(I,{variant:"primary-outline",onClick:X},{right:a(e=>[y.value?(b(),v(i,{key:1,name:"XIcon",class:g(e.class)},null,8,["class"])):(b(),v(i,{key:0,name:"FilterIcon",class:g(e.class)},null,8,["class"]))]),default:a(()=>[_(d(s.$t("general.filter"))+" ",1)]),_:1},512),[[V,l(c).purchaseTotalCount]]),l(C).hasAbilities(l(f).CREATE_INVOICE)?(b(),v(T,{key:0,to:"purchases/create"},{default:a(()=>[t(I,{variant:"primary",class:"ml-4"},{left:a(e=>[t(i,{name:"PlusIcon",class:g(e.class)},null,8,["class"])]),default:a(()=>[_(" "+d(s.$t("purchases.new_purchase")),1)]),_:1})]),_:1})):A("",!0)]),default:a(()=>[t(D,null,{default:a(()=>[t(p,{title:s.$t("general.home"),to:"dashboard"},null,8,["title"]),t(p,{title:s.$tc("purchases.purchase",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),E(t(ee,{"row-on-xl":!0,onClear:U},{default:a(()=>[t(k,{label:s.$tc("customers.customer",1)},{default:a(()=>[t(K,{modelValue:l(o).supplier_id,"onUpdate:modelValue":r[0]||(r[0]=e=>l(o).supplier_id=e),placeholder:s.$t("customers.type_or_click"),"value-prop":"id","customer-type":"purchase",label:"name"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(k,{label:s.$t("general.from")},{default:a(()=>[t(O,{modelValue:l(o).from_date,"onUpdate:modelValue":r[1]||(r[1]=e=>l(o).from_date=e),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),Ve,t(k,{label:s.$t("general.to"),class:"mt-2"},{default:a(()=>[t(O,{modelValue:l(o).to_date,"onUpdate:modelValue":r[2]||(r[2]=e=>l(o).to_date=e),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),t(k,{label:s.$t("purchases.number")},{default:a(()=>[t(Q,{modelValue:l(o).purchase_no,"onUpdate:modelValue":r[3]||(r[3]=e=>l(o).purchase_no=e)},{left:a(e=>[t(i,{name:"HashtagIcon",class:g(e.class)},null,8,["class"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),m("div",$e,[F.value?(b(),v(T,{key:0,to:`/filtered-purchases-list?selectedCompany=${l(G).selectedCompany.id}&supplier_id=${l(o).supplier_id}&status=${l(o).status}&from_date=${l(o).from_date}&to_date=${l(o).to_date}&invoice_number=${l(o).purchase_no}`,target:"_blank"},{default:a(()=>[t(I,{class:"mr-3",variant:"primary-outline",type:"button"},{default:a(()=>[m("span",Pe,d(s.$t("Download")),1)]),_:1})]),_:1},8,["to"])):A("",!0)])]),_:1},512),[[V,y.value]]),E(t(te,{title:s.$t("invoices.no_invoices"),description:s.$t("invoices.list_of_invoices")},M({default:a(()=>[t(Ie,{class:"mt-5 mb-4"})]),_:2},[l(C).hasAbilities(l(f).CREATE_INVOICE)?{name:"actions",fn:a(()=>[t(I,{variant:"primary-outline",onClick:r[4]||(r[4]=e=>s.$router.push("/admin/purchases/create"))},{left:a(e=>[t(i,{name:"PlusIcon",class:g(e.class)},null,8,["class"])]),default:a(()=>[_(" "+d(s.$t("invoices.add_new_invoice")),1)]),_:1})])}:void 0]),1032,["title","description"]),[[V,l(N)]]),E(m("div",De,[m("div",Te,[t(se,{class:"-mb-5",onChange:z},{default:a(()=>[t(ae,{title:s.$t("general.purchases"),filter:""},null,8,["title"])]),_:1}),l(c).selectedPurchases.length&&l(C).hasAbilities(l(f).DELETE_INVOICE)?(b(),v(oe,{key:0,class:"absolute float-right"},{activator:a(()=>[m("span",Se,[_(d(s.$t("general.actions"))+" ",1),t(i,{name:"ChevronDownIcon"})])]),default:a(()=>[t(le,{onClick:J},{default:a(()=>[t(i,{name:"TrashIcon",class:"mr-3 text-gray-600"}),_(" "+d(s.$t("general.delete")),1)]),_:1})]),_:1})):A("",!0)]),t(ue,{ref_key:"table",ref:B,data:q,columns:l(H),"placeholder-count":l(c).purchaseTotalCount>=20?10:5,class:"mt-10"},M({header:a(()=>[m("div",Ae,[t(R,{modelValue:l(c).selectAllField,"onUpdate:modelValue":r[5]||(r[5]=e=>l(c).selectAllField=e),variant:"primary",onChange:l(c).selectAllPurchases},null,8,["modelValue","onChange"])])]),"cell-checkbox":a(({row:e})=>[m("div",we,[t(R,{id:e.id,modelValue:l(P),"onUpdate:modelValue":r[6]||(r[6]=ie=>Ce(P)?P.value=ie:null),value:e.data.id},null,8,["id","modelValue","value"])])]),"cell-name":a(({row:e})=>[t(ne,{text:e.data.supplier.name,length:30},null,8,["text"])]),"cell-invoice_number":a(({row:e})=>[t(T,{to:{path:`purchases/${e.data.id}/view`},class:"font-medium text-primary-500"},{default:a(()=>[_(d(e.data.purchase_no),1)]),_:2},1032,["to"])]),"cell-invoice_date":a(({row:e})=>[_(d(e.data.formatted_purchase_date),1)]),"cell-total":a(({row:e})=>[t(L,{amount:e.data.total,currency:e.data.company.currency},null,8,["amount","currency"])]),"cell-due_amount":a(({row:e})=>[m("div",Fe,[t(L,{amount:e.data.due_amount,currency:e.data.currency},null,8,["amount","currency"]),t(re,{status:e.data.paid_status,class:"px-1 py-0.5 ml-2"},{default:a(()=>[_(d(e.data.paid_status),1)]),_:2},1032,["status"])])]),_:2},[j()?{name:"cell-actions",fn:a(({row:e})=>[t(ke,{row:e.data,table:B.value},null,8,["row","table"])])}:void 0]),1032,["columns","placeholder-count"])],512),[[V,!l(N)]])]),_:1})}}};export{Le as default};
