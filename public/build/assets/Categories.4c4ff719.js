import{R as E,u as D,e as N,a3 as T,x as R,I as V,Q as z,F as X,r as u,o as C,n as x,w as s,m as o,a as t,q as $,t as I,ay as A,g as M,y as q,l as k,h as S,i as L,z as W,a4 as Z,af as ee,k as te,K as ae,M as oe,b as y,S as O,az as se,T as ne,E as P,s as re,c as G,J as j,U,aa as H}from"./main.d0ffa6eb.js";const Y={props:{row:{type:Object,default:null},table:{type:Object,default:null},loadData:{type:Function,default:null},modalTitle:{type:String}},setup(v){const n=v,f=E(),e=D(),{t:d}=N(),r=T(),b=R();V();const B=z();X("utils");function m(i){r.fetchCategory(i),B.openModal({title:d(n.modalTitle),componentName:"ItemCategoryModal",size:"sm",refreshData:n.loadData})}function w(i){f.openDialog({title:d("general.are_you_sure"),message:d("settings.categories.confirm_delete"),yesLabel:d("general.yes"),noLabel:d("general.no"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async()=>{(await r.deleteCategory(i)).data.success?e.showNotification({type:"success",message:d("settings.categories.deleted_message")}):e.showNotification({type:"error",message:d("settings.categories.already_in_use")}),n.loadData&&n.loadData()})}return(i,g)=>{const a=u("BaseIcon"),l=u("BaseButton"),c=u("BaseDropdownItem"),h=u("BaseDropdown");return C(),x(h,null,{activator:s(()=>[o(b).name==="notes.view"?(C(),x(l,{key:0,variant:"primary"},{default:s(()=>[t(a,{name:"DotsHorizontalIcon",class:"h-5 text-white"})]),_:1})):(C(),x(a,{key:1,name:"DotsHorizontalIcon",class:"h-5 text-gray-500"}))]),default:s(()=>[t(c,{onClick:g[0]||(g[0]=p=>m(v.row.id))},{default:s(()=>[t(a,{name:"PencilIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),$(" "+I(i.$t("general.edit")),1)]),_:1}),t(c,{onClick:g[1]||(g[1]=p=>w(v.row.id))},{default:s(()=>[t(a,{name:"TrashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),$(" "+I(i.$t("general.delete")),1)]),_:1})]),_:1})}}};const le={class:"flex justify-between w-full"},ie=["onSubmit"],ce={class:"px-8 py-8 sm:p-6"},de={class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert"},ue=y("strong",{class:"font-bold"},"Category Code Already Exist!",-1),me=y("br",null,null,-1),ge=y("span",{class:"block sm:inline"},"Please use different unique category code.",-1),pe=y("span",{class:"absolute top-0 bottom-0 right-0 px-4 py-3"},[y("svg",{class:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"})],-1),ye=[ue,me,ge,pe],fe={class:"z-0 flex justify-end px-4 py-4 border-t border-solid border-gray-light"},J={setup(v){const n=z(),f=D();A();const e=T();R();const{t:d}=N();let r=M(!1);q(["Invoice","Estimate","Payment"]),M(["customer","customerCustom"]);const b=k(()=>n.active&&n.componentName==="ItemCategoryModal"),B=k(()=>({currentCategory:{name:{required:S.withMessage(d("validation.required"),L),minLength:S.withMessage(d("validation.name_min_length",{count:3}),W(3))},code:{required:S.withMessage(d("validation.required"),L),maxLength:S.withMessage(d("categories.maxlength"),Z(5)),alphaNum:S.withMessage(d("categories.no_space_allowed"),ee)}}})),m=te(B,k(()=>e));ae(()=>e.currentCategory.code,a=>{w()});async function w(){let a=e.currentCategory.type?e.currentCategory.type:n.option1,l={id:e.currentCategoryId,type:a,code:e.currentCategory.code};await e.checkCategoryCodeAvailability(l).then(c=>{c.data&&(console.log(e.currentCategory.type),console.log(c.data))}).catch(c=>{console.log(c)})}oe(()=>{});async function i(){if(m.value.currentCategory.$touch(),m.value.currentCategory.$invalid)return!0;if(r.value=!0,e.isEdit){let a={id:e.currentCategory.id,...e.currentCategory};await e.updateCategory(a).then(l=>{r.value=!1,l.data&&(f.showNotification({type:"success",message:d("settings.categories.updated")}),n.refreshData&&n.refreshData(),g())}).catch(l=>{r.value=!1})}else e.currentCategory.type=n.option1,await e.addCategory(e.currentCategory).then(a=>{r.value=!1,a.data&&f.showNotification({type:"success",message:d("settings.categories.added")}),n.refreshData&&n.refreshData(),g()}).catch(a=>{r.value=!1})}function g(){n.closeModal(),setTimeout(()=>{e.resetCurrentCategory(),m.value.$reset()},300)}return(a,l)=>{const c=u("BaseIcon"),h=u("BaseInput"),p=u("BaseInputGroup"),K=u("BaseInputGrid"),F=u("BaseButton"),Q=u("BaseModal");return C(),x(Q,{show:o(b),onClose:g,onOpen:a.setFields},{header:s(()=>[y("div",le,[$(I(o(n).title)+" ",1),t(c,{name:"XIcon",class:"h-6 w-6 text-gray-500 cursor-pointer",onClick:g})])]),default:s(()=>[y("form",{action:"",onSubmit:re(i,["prevent"])},[y("div",ce,[t(K,{layout:"one-column"},{default:s(()=>[O(y("input",{type:"hidden","onUpdate:modelValue":l[0]||(l[0]=_=>o(e).currentCategory.type=_)},null,512),[[se,o(e).currentCategory.type]]),t(p,{label:a.$t("settings.customization.notes.name"),variant:"vertical",error:o(m).currentCategory.name.$error&&o(m).currentCategory.name.$errors[0].$message,required:""},{default:s(()=>[t(h,{modelValue:o(e).currentCategory.name,"onUpdate:modelValue":l[1]||(l[1]=_=>o(e).currentCategory.name=_),invalid:o(m).currentCategory.name.$error,type:"text",onInput:l[2]||(l[2]=_=>o(m).currentCategory.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),t(p,{label:a.$t("settings.categories.code"),variant:"vertical",error:o(m).currentCategory.code.$error&&o(m).currentCategory.code.$errors[0].$message,required:""},{default:s(()=>[t(h,{modelValue:o(e).currentCategory.code,"onUpdate:modelValue":l[3]||(l[3]=_=>o(e).currentCategory.code=_),invalid:o(m).currentCategory.code.$error,type:"text",onInput:l[4]||(l[4]=_=>o(m).currentCategory.code.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),O(y("div",de,ye,512),[[ne,!o(e).codeAvailability.status]])]),_:1})]),y("div",fe,[t(F,{class:"mr-2",variant:"primary-outline",type:"button",onClick:g},{default:s(()=>[$(I(a.$t("general.cancel")),1)]),_:1}),t(F,{disabled:!o(e).codeAvailability.status||o(r),loading:o(r),variant:"primary",type:"submit"},{left:s(_=>[t(c,{name:"SaveIcon",class:P(_.class)},null,8,["class"])]),default:s(()=>[$(" "+I(o(e).isEdit?a.$t("general.update"):a.$t("general.save")),1)]),_:1},8,["disabled","loading"])])],40,ie)]),_:1},8,["show","onOpen"])}}},_e={setup(v){const{t:n}=N(),f=z();E(),A();const e=T();D();const d=V(),r=M(""),b=k(()=>[{key:"name",label:n("settings.customization.notes.name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"code",label:n("settings.categories.code"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"actions",label:"",tdClass:"text-right text-sm font-medium",sortable:!1}]);async function B({page:i,filter:g,sort:a}){let l=q({orderByField:a.fieldName||"created_at",orderBy:a.order||"desc",page:i,type:"item"}),c=await e.fetchCategories(l);return{data:c.data.data,pagination:{totalPages:c.data.meta.last_page,currentPage:i,totalCount:c.data.meta.total,limit:5}}}async function m(){await f.openModal({title:n("settings.categories.items.add_category"),componentName:"ItemCategoryModal",size:"sm",refreshData:r.value&&r.value.refresh,option1:"item"})}async function w(){r.value&&r.value.refresh()}return(i,g)=>{const a=u("BaseIcon"),l=u("BaseButton"),c=u("BaseTable"),h=u("BaseSettingCard");return C(),G(H,null,[t(J),t(h,{title:i.$t("settings.categories.items.heading"),description:i.$t("settings.categories.items.description")},{action:s(()=>[o(d).hasAbilities(o(j).CREATE_CATEGORY)?(C(),x(l,{key:0,variant:"primary-outline",onClick:m},{left:s(p=>[t(a,{class:P(p.class),name:"PlusIcon"},null,8,["class"])]),default:s(()=>[$(" "+I(i.$t("settings.categories.add")),1)]),_:1})):U("",!0)]),default:s(()=>[t(c,{ref_key:"table",ref:r,data:B,columns:o(b),class:"mt-14"},{"cell-actions":s(({row:p})=>[t(Y,{row:p.data,table:r.value,"load-data":w,"modal-title":"settings.categories.items.edit"},null,8,["row","table"])]),_:1},8,["columns"])]),_:1},8,["title","description"])],64)}}},Ce={setup(v){const{t:n}=N(),f=z();E(),A();const e=T();D();const d=V(),r=M(""),b=k(()=>[{key:"name",label:n("settings.customization.notes.name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"code",label:n("settings.categories.code"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"actions",label:"",tdClass:"text-right text-sm font-medium",sortable:!1}]);async function B({page:i,filter:g,sort:a}){let l=q({orderByField:a.fieldName||"created_at",orderBy:a.order||"desc",page:i,type:"client"}),c=await e.fetchCategories(l);return{data:c.data.data,pagination:{totalPages:c.data.meta.last_page,currentPage:i,totalCount:c.data.meta.total,limit:5}}}async function m(){await f.openModal({title:n("settings.categories.clients.add_category"),componentName:"ItemCategoryModal",size:"sm",refreshData:r.value&&r.value.refresh,option1:"client"})}async function w(){r.value&&r.value.refresh()}return(i,g)=>{const a=u("BaseIcon"),l=u("BaseButton"),c=u("BaseTable"),h=u("BaseSettingCard");return C(),G(H,null,[t(J),t(h,{title:i.$t("settings.categories.clients.heading"),description:i.$t("settings.categories.clients.description")},{action:s(()=>[o(d).hasAbilities(o(j).CREATE_CATEGORY)?(C(),x(l,{key:0,variant:"primary-outline",onClick:m},{left:s(p=>[t(a,{class:P(p.class),name:"PlusIcon"},null,8,["class"])]),default:s(()=>[$(" "+I(i.$t("settings.categories.add")),1)]),_:1})):U("",!0)]),default:s(()=>[t(c,{ref_key:"table",ref:r,data:B,columns:o(b),class:"mt-14"},{"cell-actions":s(({row:p})=>[t(Y,{row:p.data,table:r.value,"load-data":w,"modal-title":"settings.categories.clients.edit"},null,8,["row","table"])]),_:1},8,["columns"])]),_:1},8,["title","description"])],64)}}},he={class:"relative"},be={setup(v){return(n,f)=>{const e=u("BaseTab"),d=u("BaseTabGroup"),r=u("BaseCard");return C(),G("div",he,[t(r,{"container-class":"px-4 py-5 sm:px-8 sm:py-2"},{default:s(()=>[t(d,null,{default:s(()=>[t(e,{"tab-panel-container":"py-4 mt-px",title:n.$t("settings.categories.items.title")},{default:s(()=>[t(_e)]),_:1},8,["title"]),t(e,{"tab-panel-container":"py-4 mt-px",title:n.$t("settings.categories.clients.title")},{default:s(()=>[t(Ce)]),_:1},8,["title"])]),_:1})]),_:1})])}}};export{be as default};
