import{x as f,a2 as g,H as m,B as a,v as r,u as p,ad as d,ae as _}from"./main.d0ffa6eb.js";function o(){return{name:"",code:"",contact_name:null,email:null,phone:null,description:null,state:null,city:null,address_street_1:null,address_street_2:null,zip:null,state_ar:null,city_ar:null,address_street_1_ar:null,address_street_2_ar:null,zip_ar:null,creator_id:null,country_id:null,customFields:[],created_at:"",fields:[]}}const b=(h=!1)=>{const S=h?window.pinia.defineStore:_,{global:u}=window.i18n;return S({id:"store",state:()=>({suppliers:[],totalSuppliers:0,selectAllField:!1,selectedSuppliers:[],selectedViewSupplier:{},isFetchingInitialSettings:!1,isFetchingViewData:!1,currentSupplier:{...o()},currentSupplierId:null,codeAvailability:[]}),getters:{isEdit:t=>!!t.currentSupplier.id},actions:{resetCurrentSupplier(){this.currentSupplier={...o()},this.currentSupplierId=null},copyAddress(){this.currentSupplier.shipping={...this.currentSupplier.billing,type:"shipping"}},fetchSupplierInitialSettings(t){const i=f(),s=g(),e=m();this.isFetchingInitialSettings=!0;let l=[];t?l=[this.fetchStore(i.params.id)]:this.currentSupplier.currency_id=e.selectedCompanyCurrency.id,Promise.all([s.fetchCurrencies(),s.fetchCountries(),...l]).then(async([n,c,w])=>{this.isFetchingInitialSettings=!1}).catch(n=>{a(n)})},fetchStores(t){return new Promise((i,s)=>{r.get("/api/v1/stores",{params:t}).then(e=>{this.suppliers=e.data.data,this.totalSuppliers=e.data.meta.customer_total_count,i(e)}).catch(e=>{a(e),s(e)})})},fetchViewStore(t){return new Promise((i,s)=>{this.isFetchingViewData=!0,r.get(`/api/v1/stores/${t.id}/stats`,{params:t}).then(e=>{this.selectedViewSupplier={},Object.assign(this.selectedViewSupplier,e.data.data),this.setAddressStub(e.data.data),this.isFetchingViewData=!1,i(e)}).catch(e=>{this.isFetchingViewData=!1,a(e),s(e)})})},fetchStore(t){return new Promise((i,s)=>{r.get(`/api/v1/stores/${t}`).then(e=>{Object.assign(this.currentSupplier,e.data.data),this.currentSupplierId=e.data.data.id,this.setAddressStub(e.data.data),i(e)}).catch(e=>{a(e),s(e)})})},checkStoreCodeAvailability(t){return new Promise((i,s)=>{r.post("/api/v1/stores/code_availability",t).then(e=>{e.data&&(this.codeAvailability=e.data),i(e)}).catch(e=>{a(e),s(e)})})},addStore(t){return new Promise((i,s)=>{r.post("/api/v1/stores",t).then(e=>{this.suppliers.push(e.data.data),p().showNotification({type:"success",message:u.t("stores.created_message")}),i(e)}).catch(e=>{a(e),s(e)})})},updateStore(t){return new Promise((i,s)=>{r.put(`/api/v1/stores/${t.id}`,t).then(e=>{if(e.data){let l=this.suppliers.findIndex(c=>c.id===e.data.data.id);this.suppliers[l]=t,p().showNotification({type:"success",message:u.t("stores.updated_message")})}i(e)}).catch(e=>{a(e),s(e)})})},deleteStore(t){const i=p();return new Promise((s,e)=>{r.post("/api/v1/stores/delete",t).then(l=>{let n=this.suppliers.findIndex(c=>c.id===t);this.suppliers.splice(n,1),i.showNotification({type:"success",message:u.tc("stores.deleted_message",1)}),s(l)}).catch(l=>{a(l),e(l)})})},deleteMultipleStores(){const t=p();return new Promise((i,s)=>{r.post("/api/v1/stores/delete",{ids:this.selectedSuppliers}).then(e=>{this.selectedSuppliers.forEach(l=>{let n=this.suppliers.findIndex(c=>c.id===l.id);this.suppliers.splice(n,1)}),t.showNotification({type:"success",message:u.tc("stores.deleted_message",2)}),i(e)}).catch(e=>{a(e),s(e)})})},setSelectAllState(t){this.selectAllField=t},selectedSupplier(t){this.selectedSuppliers=t,this.selectedSuppliers.length===this.suppliers.length?this.selectAllField=!0:this.selectAllField=!1},selectAllSuppliers(){if(this.selectedSuppliers.length===this.suppliers.length)this.selectedSuppliers=[],this.selectAllField=!1;else{let t=this.suppliers.map(i=>i.id);this.selectedSuppliers=t,this.selectAllField=!0}},setAddressStub(t){t.billing||(this.currentSupplier.billing={...d}),t.shipping||(this.currentSupplier.shipping={...d})}}})()};export{b as u};
