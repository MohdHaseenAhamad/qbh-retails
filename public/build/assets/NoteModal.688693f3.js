import{Q as j,u as L,ay as T,P as A,am as F,V as K,x as O,e as Q,g as S,y as R,l as g,h as f,i as h,z as X,k as H,K as J,M as W,r as l,o as Y,n as Z,w as i,b as y,q as _,t as $,m as e,a as n,E as ee,s as te}from"./main.d0ffa6eb.js";/* empty css                                                  */const ae={class:"flex justify-between w-full"},oe=["onSubmit"],se={class:"px-8 py-8 sm:p-6"},ne={class:"z-0 flex justify-end px-4 py-4 border-t border-solid border-gray-light"},le={setup(re){const u=j(),B=L(),a=T(),C=A(),M=F(),V=K(),d=O(),{t:m}=Q();let c=S(!1);const q=R(["Invoice","Estimate","Payment","Credit","Debit","Purchase"]);let p=S(["customer","customerCustom"]);const z=g(()=>u.active&&u.componentName==="NoteModal"),E=g(()=>({currentNote:{name:{required:f.withMessage(m("validation.required"),h),minLength:f.withMessage(m("validation.name_min_length",{count:3}),X(3))},notes:{required:f.withMessage(m("validation.required"),h)},type:{required:f.withMessage(m("validation.required"),h)}}})),o=H(E,g(()=>a));J(()=>a.currentNote.type,t=>{I()}),W(()=>{});function I(){p.value=["customer","customerCustom"],a.currentNote.type=="Invoice"&&p.value.push("invoice","invoiceCustom"),a.currentNote.type=="Estimate"&&p.value.push("estimate","estimateCustom"),a.currentNote.type=="Payment"&&p.value.push("payment","paymentCustom")}async function P(){if(o.value.currentNote.$touch(),o.value.currentNote.$invalid)return!0;if(c.value=!0,a.isEdit){let t={id:a.currentNote.id,...a.currentNote};await a.updateNote(t).then(s=>{c.value=!1,s.data&&(B.showNotification({type:"success",message:m("settings.customization.notes.note_updated")}),u.refreshData&&u.refreshData(),v())}).catch(s=>{c.value=!1})}else await a.addNote(a.currentNote).then(t=>{c.value=!1,t.data&&(B.showNotification({type:"success",message:m("settings.customization.notes.note_added")}),(d.name==="invoices.create"&&t.data.data.type==="Invoice"||d.name==="invoices.edit"&&t.data.data.type==="Invoice")&&C.selectNote(t.data.data),(d.name==="estimates.create"&&t.data.data.type==="Estimate"||d.name==="estimates.edit"&&t.data.data.type==="Estimate")&&V.selectNote(t.data.data),(d.name==="payments.create"&&t.data.data.type==="Payment"||d.name==="payments.edit"&&t.data.data.type==="Payment")&&M.selectNote(t.data.data)),u.refreshData&&u.refreshData(),v()}).catch(t=>{c.value=!1})}function v(){u.closeModal(),setTimeout(()=>{a.resetCurrentNote(),o.value.$reset()},300)}return(t,s)=>{const b=l("BaseIcon"),D=l("BaseInput"),N=l("BaseInputGroup"),k=l("BaseMultiselect"),x=l("BaseCustomInput"),G=l("BaseInputGrid"),w=l("BaseButton"),U=l("BaseModal");return Y(),Z(U,{show:e(z),onClose:v,onOpen:I},{header:i(()=>[y("div",ae,[_($(e(u).title)+" ",1),n(b,{name:"XIcon",class:"h-6 w-6 text-gray-500 cursor-pointer",onClick:v})])]),default:i(()=>[y("form",{action:"",onSubmit:te(P,["prevent"])},[y("div",se,[n(G,{layout:"one-column"},{default:i(()=>[n(N,{label:t.$t("settings.customization.notes.name"),variant:"vertical",error:e(o).currentNote.name.$error&&e(o).currentNote.name.$errors[0].$message,required:""},{default:i(()=>[n(D,{modelValue:e(a).currentNote.name,"onUpdate:modelValue":s[0]||(s[0]=r=>e(a).currentNote.name=r),invalid:e(o).currentNote.name.$error,type:"text",onInput:s[1]||(s[1]=r=>e(o).currentNote.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),n(N,{label:t.$t("settings.customization.notes.type"),error:e(o).currentNote.type.$error&&e(o).currentNote.type.$errors[0].$message,required:""},{default:i(()=>[n(k,{modelValue:e(a).currentNote.type,"onUpdate:modelValue":s[2]||(s[2]=r=>e(a).currentNote.type=r),options:e(q),"value-prop":"type",class:"mt-2"},null,8,["modelValue","options"])]),_:1},8,["label","error"]),n(N,{label:t.$t("settings.customization.notes.notes"),error:e(o).currentNote.notes.$error&&e(o).currentNote.notes.$errors[0].$message,required:""},{default:i(()=>[n(x,{modelValue:e(a).currentNote.notes,"onUpdate:modelValue":s[3]||(s[3]=r=>e(a).currentNote.notes=r),invalid:e(o).currentNote.notes.$error,fields:e(p),onInput:s[4]||(s[4]=r=>e(o).currentNote.notes.$touch())},null,8,["modelValue","invalid","fields"])]),_:1},8,["label","error"])]),_:1})]),y("div",ne,[n(w,{class:"mr-2",variant:"primary-outline",type:"button",onClick:v},{default:i(()=>[_($(t.$t("general.cancel")),1)]),_:1}),n(w,{loading:e(c),disabled:e(c),variant:"primary",type:"submit"},{left:i(r=>[n(b,{name:"SaveIcon",class:ee(r.class)},null,8,["class"])]),default:i(()=>[_(" "+$(e(a).isEdit?t.$t("general.update"):t.$t("general.save")),1)]),_:1},8,["loading","disabled"])])],40,oe)]),_:1},8,["show"])}}};export{le as _};
