import{H as z,a2 as F,e as Y,g as B,y as D,l as f,K as O,h as p,i as g,k as U,r as c,o as G,c as P,a as o,w as u,m as e,E as T,q as Z,t as j,b as V,p as q,s as H}from"./main.d0ffa6eb.js";const K=["onSubmit"],R={class:"divide-y divide-gray-200"},A={class:"divide-y divide-gray-200"},W={setup(J){const v=z(),d=F(),{t:m,tm:L}=Y();let b=B(!1),i=B(!1);const n=D({...v.selectedCompanySettings});f(()=>d.config.retrospective_edits.map(t=>(t.title=m(t.key),t))),O(()=>n.carbon_date_format,t=>{if(t){const a=d.dateFormats.find(l=>l.carbon_format_value===t);n.moment_date_format=a.moment_format_value}});const y=f({get:()=>n.discount_per_item==="YES",set:async t=>{const a=t?"YES":"NO";let l={settings:{discount_per_item:a,deduction_per_item:t?"NO":"YES"}};n.deduction_per_item=t?"NO":"YES",n.discount_per_item=a,await v.updateCompanySettings({data:l,message:"general.setting_updated"})}}),$=f({get:()=>n.deduction_per_item==="YES",set:async t=>{const a=t?"YES":"NO";let l={settings:{deduction_per_item:a,discount_per_item:t?"NO":"YES"}};n.discount_per_item=t?"NO":"YES",n.deduction_per_item=a,await v.updateCompanySettings({data:l,message:"general.setting_updated"})}}),h=f(()=>({currency:{required:p.withMessage(m("validation.required"),g)},language:{required:p.withMessage(m("validation.required"),g)},carbon_date_format:{required:p.withMessage(m("validation.required"),g)},moment_date_format:{required:p.withMessage(m("validation.required"),g)},time_zone:{required:p.withMessage(m("validation.required"),g)},fiscal_year:{required:p.withMessage(m("validation.required"),g)}})),r=U(h,f(()=>n));w();async function w(){i.value=!0,Promise.all([d.fetchCurrencies(),d.fetchDateFormats(),d.fetchTimeZones()]).then(([t])=>{i.value=!1})}async function k(){r.value.$touch(),!r.value.$invalid&&(b.value=!0,await v.updateCompanySettings({data:{settings:{...n}},message:"settings.preferences.updated_message"}),b.value=!1)}return(t,a)=>{const l=c("BaseMultiselect"),_=c("BaseInputGroup"),I=c("BaseInputGrid"),C=c("BaseIcon"),E=c("BaseButton"),M=c("BaseDivider"),S=c("BaseSwitchSection"),N=c("BaseSettingCard");return G(),P("form",{action:"",class:"relative",onSubmit:H(k,["prevent"])},[o(N,{title:t.$t("settings.menu_title.preferences"),description:t.$t("settings.preferences.general_settings")},{default:u(()=>[o(I,{class:"mt-5"},{default:u(()=>[o(_,{"content-loading":e(i),label:t.$tc("settings.preferences.currency"),"help-text":t.$t("settings.preferences.company_currency_unchangeable"),error:e(r).currency.$error&&e(r).currency.$errors[0].$message,required:""},{default:u(()=>[o(l,{modelValue:e(n).currency,"onUpdate:modelValue":a[0]||(a[0]=s=>e(n).currency=s),"content-loading":e(i),options:e(d).currencies,label:"name","value-prop":"id",searchable:!0,"track-by":"name",invalid:e(r).currency.$error,disabled:"",class:"w-full"},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["content-loading","label","help-text","error"]),o(_,{label:t.$tc("settings.preferences.default_language"),"content-loading":e(i),error:e(r).language.$error&&e(r).language.$errors[0].$message,required:""},{default:u(()=>[o(l,{modelValue:e(n).language,"onUpdate:modelValue":a[1]||(a[1]=s=>e(n).language=s),"content-loading":e(i),options:e(d).config.languages,label:"name","value-prop":"code",class:"w-full","track-by":"code",searchable:!0,invalid:e(r).language.$error},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),o(_,{label:t.$tc("settings.preferences.time_zone"),"content-loading":e(i),error:e(r).time_zone.$error&&e(r).time_zone.$errors[0].$message,required:""},{default:u(()=>[o(l,{modelValue:e(n).time_zone,"onUpdate:modelValue":a[2]||(a[2]=s=>e(n).time_zone=s),"content-loading":e(i),options:e(d).timeZones,label:"key","value-prop":"value","track-by":"key",searchable:!0,invalid:e(r).time_zone.$error},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),o(_,{label:t.$tc("settings.preferences.date_format"),"content-loading":e(i),error:e(r).carbon_date_format.$error&&e(r).carbon_date_format.$errors[0].$message,required:""},{default:u(()=>[o(l,{modelValue:e(n).carbon_date_format,"onUpdate:modelValue":a[3]||(a[3]=s=>e(n).carbon_date_format=s),"content-loading":e(i),options:e(d).dateFormats,label:"display_date","value-prop":"carbon_format_value","track-by":"carbon_format_value",searchable:"",invalid:e(r).carbon_date_format.$error,class:"w-full"},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),o(_,{"content-loading":e(i),error:e(r).fiscal_year.$error&&e(r).fiscal_year.$errors[0].$message,label:t.$tc("settings.preferences.fiscal_year"),required:""},{default:u(()=>[o(l,{modelValue:e(n).fiscal_year,"onUpdate:modelValue":a[4]||(a[4]=s=>e(n).fiscal_year=s),"content-loading":e(i),options:e(d).config.fiscal_years,label:"key","value-prop":"value",invalid:e(r).fiscal_year.$error,"track-by":"key",searchable:!0,class:"w-full"},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["content-loading","error","label"])]),_:1}),o(E,{"content-loading":e(i),disabled:e(b),loading:e(b),type:"submit",class:"mt-6"},{left:u(s=>[o(C,{name:"SaveIcon",class:T(s.class)},null,8,["class"])]),default:u(()=>[Z(" "+j(t.$tc("settings.company_info.save")),1)]),_:1},8,["content-loading","disabled","loading"]),o(M,{class:"mt-6 mb-2"}),V("ul",R,[o(S,{modelValue:e(y),"onUpdate:modelValue":a[5]||(a[5]=s=>q(y)?y.value=s:null),title:t.$t("settings.preferences.discount_per_item"),description:t.$t("settings.preferences.discount_setting_description")},null,8,["modelValue","title","description"])]),V("ul",A,[o(S,{modelValue:e($),"onUpdate:modelValue":a[6]||(a[6]=s=>q($)?$.value=s:null),title:t.$t("settings.preferences.deduction_per_item"),description:t.$t("settings.preferences.deduction_setting_description")},null,8,["modelValue","title","description"])])]),_:1},8,["title","description"])],40,K)}}};export{W as default};
