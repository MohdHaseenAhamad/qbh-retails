import{P as U,r as c,o as v,c as E,a as i,w as a,m as n,E as _,H as A,a1 as J,ao as Q,ah as W,e as X,x as Y,f as Z,g as F,l as I,h as m,i as b,a4 as x,a5 as ee,aP as ne,k as ie,K as te,b as B,n as w,t as P,U as D,q as T,s as oe,aa as ae}from"./main.d0ffa6eb.js";import{_ as se,a as le,b as ce,c as re,d as de}from"./ItemModal.720790e2.js";import{_ as ue}from"./SelectTemplateButton.5704c8fd.js";import{_ as me}from"./ExchangeRateConverter.ef383681.js";/* empty css                                                                            */import{_ as ve}from"./CreateCustomFields.e1e8603d.js";import{_ as ge}from"./TaxTypeModal.fd62b2ec.js";import{_ as pe}from"./PreparedByModal.fa78cd8f.js";import{_ as _e}from"./BankDetailModal.ae909e8c.js";import"./DragIcon.e0a4ab5f.js";import"./ItemUnitModal.dc6156ec.js";import"./SelectNotePopup.f61bb6cc.js";import"./NoteModal.688693f3.js";/* empty css                                                  *//* empty css                                                                      */const fe={class:"grid grid-cols-12 gap-8 mt-6 mb-8"},Ie={props:{v:{type:Object,default:null},isLoading:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1}},setup(t){const e=U();function $(o){e.newInvoice.prepared_by_id=o}function S(o){e.newInvoice.bank_detail_id=o}return(o,l)=>{const k=c("BaseCustomerSelectPopup"),d=c("BaseInputGroup"),u=c("BaseDatePicker"),f=c("BaseInput"),h=c("BasePreparedBySelect"),g=c("BaseBankDetailSelect"),L=c("BaseInputGrid");return v(),E("div",fe,[i(L,{class:"col-span-12 sm:grid-cols-4 md:grid-cols-4"},{default:a(()=>[i(d,{label:o.$t("invoices.client"),"content-loading":t.isLoading,required:""},{default:a(()=>[i(k,{modelValue:n(e).newInvoice.customer,"onUpdate:modelValue":l[0]||(l[0]=s=>n(e).newInvoice.customer=s),valid:t.v.customer_id,"content-loading":t.isLoading,type:"invoice"},null,8,["modelValue","valid","content-loading"])]),_:1},8,["label","content-loading"]),i(d,{label:o.$t("invoices.invoice_date"),"content-loading":t.isLoading,required:"",error:t.v.invoice_date.$error&&t.v.invoice_date.$errors[0].$message},{default:a(()=>[i(u,{modelValue:n(e).newInvoice.invoice_date,"onUpdate:modelValue":l[1]||(l[1]=s=>n(e).newInvoice.invoice_date=s),"content-loading":t.isLoading,"calendar-button":!0,"calendar-button-icon":"calendar",disabled:"",enableTime:"true",time24hr:"true"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading","error"]),i(d,{label:o.$t("invoices.due_date"),"content-loading":t.isLoading,required:"",error:t.v.due_date.$error&&t.v.due_date.$errors[0].$message},{default:a(()=>[i(u,{modelValue:n(e).newInvoice.due_date,"onUpdate:modelValue":l[2]||(l[2]=s=>n(e).newInvoice.due_date=s),"content-loading":t.isLoading,"calendar-button":!0,"calendar-button-icon":"calendar",disabled:n(e).newInvoice.is_edit?n(e).newInvoice.is_edit!="1":!1},null,8,["modelValue","content-loading","disabled"])]),_:1},8,["label","content-loading","error"]),i(d,{label:o.$t("invoices.invoice_number"),"content-loading":t.isLoading,error:t.v.invoice_number.$error&&t.v.invoice_number.$errors[0].$message,required:""},{default:a(()=>[i(f,{disabled:"",modelValue:n(e).newInvoice.invoice_number,"onUpdate:modelValue":l[3]||(l[3]=s=>n(e).newInvoice.invoice_number=s),"content-loading":t.isLoading,onInput:l[4]||(l[4]=s=>t.v.invoice_number.$touch())},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading","error"]),i(d,{class:_(n(e).newInvoice.is_edit?n(e).newInvoice.is_edit=="1"?"":"disable":""),label:o.$t("invoices.prepared_by"),"content-loading":t.isLoading},{default:a(()=>[i(h,{type:"Invoice","store-prop":o.newInvoice,store:n(e),"content-loading":t.isLoading,onSelect:$,item:n(e).newInvoice.prepared_by_id},null,8,["store-prop","store","content-loading","item"])]),_:1},8,["class","label","content-loading"]),i(d,{label:o.$t("invoices.bank_Detail"),"content-loading":t.isLoading,class:_(n(e).newInvoice.is_edit?n(e).newInvoice.is_edit=="1"?"":"disable":"")},{default:a(()=>[i(g,{type:"Invoice","store-prop":o.newInvoice,store:n(e),"content-loading":t.isLoading,onSelect:S,item:n(e).newInvoice.bank_detail_id},null,8,["store-prop","store","content-loading","item"])]),_:1},8,["label","content-loading","class"]),i(d,{label:o.$t("invoices.upper_margin"),"content-loading":t.isLoading},{default:a(()=>[i(f,{modelValue:n(e).newInvoice.upper_margin,"onUpdate:modelValue":l[5]||(l[5]=s=>n(e).newInvoice.upper_margin=s),"content-loading":t.isLoading},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),i(d,{label:o.$t("invoices.lower_margin"),"content-loading":t.isLoading},{default:a(()=>[i(f,{modelValue:n(e).newInvoice.lower_margin,"onUpdate:modelValue":l[6]||(l[6]=s=>n(e).newInvoice.lower_margin=s),"content-loading":t.isLoading},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),i(me,{store:n(e),"store-prop":"newInvoice",v:t.v,"is-loading":t.isLoading,"is-edit":t.isEdit,"customer-currency":n(e).newInvoice.currency_id},null,8,["store","v","is-loading","is-edit","customer-currency"])]),_:1})])}}},be=["onSubmit"],we={class:"flex"},ye={class:"block mt-10 invoice-foot lg:flex lg:justify-between lg:items-start"},Be={class:"relative w-full lg:w-1/2 lg:mr-4"},Ge={setup(t){const e=U(),$=A(),S=J();Q(),W();const{t:o}=X();let l=Y(),k=Z();const d="newInvoice";let u=F(!1);const f=I(()=>e.newInvoice.is_edit==1),h=F(["customer","company","customerCustom","invoice","invoiceCustom"]);let g=I(()=>e.isFetchingInvoice||e.isFetchingInitialSettings),L=I(()=>s.value?o("invoices.edit_invoice"):o("invoices.new_invoice")),s=I(()=>l.name==="invoices.edit");const G={invoice_date:{required:m.withMessage(o("validation.required"),b)},due_date:{required:m.withMessage(o("validation.required"),b)},reference_number:{maxLength:m.withMessage(o("validation.price_maxlength"),x(255))},customer_id:{required:m.withMessage(o("validation.required"),b)},invoice_number:{required:m.withMessage(o("validation.required"),b)},exchange_rate:{required:ee(function(){return m.withMessage(o("validation.required"),b),e.showExchangeRate}),decimal:m.withMessage(o("validation.valid_exchange_rate"),ne)}},y=ie(G,I(()=>e.newInvoice),{$scope:d});S.resetCustomFields(),y.value.$reset,e.resetCurrentInvoice(),e.fetchInvoiceInitialSettings(s.value),te(()=>e.newInvoice.customer,r=>{r&&r.currency?e.newInvoice.selectedCurrency=r.currency:e.newInvoice.selectedCurrency=$.selectedCompanyCurrency});async function N(){if(y.value.$touch(),y.value.$invalid)return!1;u.value=!0;let r={...e.newInvoice,sub_total:e.getSubTotal,total:e.getTotal,tax:e.getTotalTax,prepared_by_id:e.newInvoice.prepared_by_id?e.newInvoice.prepared_by_id.id:"",bank_detail_id:e.newInvoice.bank_detail_id?e.newInvoice.bank_detail_id.id:""};try{const p=await(s.value?e.updateInvoice:e.addInvoice)(r);k.push(`/admin/invoices/${p.data.data.id}/view`)}catch(V){console.error(V)}u.value=!1}return(r,V)=>{const p=c("BaseBreadcrumbItem"),H=c("BaseBreadcrumb"),C=c("BaseButton"),R=c("router-link"),M=c("BaseIcon"),j=c("BasePageHeader"),z=c("BaseInputGrid"),K=c("BaseScrollPane"),O=c("BasePage");return v(),E(ae,null,[i(se),i(le),i(pe),i(_e),i(ge),i(O,{class:"relative invoice-create-page"},{default:a(()=>[B("form",{onSubmit:oe(N,["prevent"])},[i(j,{title:n(L)},{actions:a(()=>[r.$route.name==="invoices.edit"?(v(),w(R,{key:0,to:`/invoices/pdf/${n(e).newInvoice.unique_hash}`,target:"_blank"},{default:a(()=>[i(C,{class:"mr-3",variant:"primary-outline",type:"button"},{default:a(()=>[B("span",we,P(r.$t("general.view_pdf")),1)]),_:1})]),_:1},8,["to"])):D("",!0),i(C,{loading:n(u),disabled:n(u),variant:"primary",type:"submit"},{left:a(q=>[n(u)?D("",!0):(v(),w(M,{key:0,name:"SaveIcon",class:_(q.class)},null,8,["class"]))]),default:a(()=>[T(" "+P(r.$t("invoices.save_invoice")),1)]),_:1},8,["loading","disabled"])]),default:a(()=>[i(H,null,{default:a(()=>[i(p,{title:r.$t("general.home"),to:"/admin/dashboard"},null,8,["title"]),i(p,{title:r.$tc("invoices.invoice",2),to:"/admin/invoices"},null,8,["title"]),r.$route.name==="invoices.edit"?(v(),w(p,{key:0,title:r.$t("invoices.edit_invoice"),to:"#",active:""},null,8,["title"])):(v(),w(p,{key:1,title:r.$t("invoices.new_invoice"),to:"#",active:""},null,8,["title"]))]),_:1})]),_:1},8,["title"]),i(Ie,{v:n(y),"is-loading":n(g),"is-edit":n(s)},null,8,["v","is-loading","is-edit"]),i(K,null,{default:a(()=>[i(ce,{currency:n(e).newInvoice.selectedCurrency,"is-loading":n(g),"item-validation-scope":d,store:n(e),"is-draft-mode":n(f),"store-prop":"newInvoice"},null,8,["currency","is-loading","store","is-draft-mode"]),B("div",ye,[B("div",Be,[i(re,{store:n(e),"store-prop":"newInvoice",fields:h.value,type:"Invoice",class:_(n(e).newInvoice.is_edit?n(e).newInvoice.is_edit=="1"?"":"disable":"")},null,8,["store","fields","class"])]),i(de,{currency:n(e).newInvoice.selectedCurrency,"is-loading":n(g),store:n(e),"store-prop":"newInvoice","tax-popup-type":"invoice",class:_(n(e).newInvoice.is_edit?n(e).newInvoice.is_edit=="1"?"":"disable":"")},null,8,["currency","is-loading","store","class"])]),i(z,{class:"sm:grid-cols-4 md:grid-cols-4 col-span-12 mb-4"},{default:a(()=>[i(ve,{type:"Invoice","is-edit":n(s),"is-loading":n(g),store:n(e),"store-prop":"newInvoice","custom-field-scope":d,disable:n(e).newInvoice.is_edit?n(e).newInvoice.is_edit!="1":!1},null,8,["is-edit","is-loading","store","disable"]),i(ue,{store:n(e),"store-prop":"newInvoice","component-name":"InvoiceTemplate"},null,8,["store"])]),_:1}),i(C,{loading:n(u),disabled:n(u),variant:"primary",type:"submit"},{left:a(q=>[n(u)?D("",!0):(v(),w(M,{key:0,name:"SaveIcon",class:_(q.class)},null,8,["class"]))]),default:a(()=>[T(" "+P(r.$t("invoices.save_invoice")),1)]),_:1},8,["loading","disabled"])]),_:1})],40,be)]),_:1})],64)}}};export{Ge as default};
