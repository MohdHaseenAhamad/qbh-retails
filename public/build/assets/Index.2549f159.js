import{ap as ae,P as se,R as le,u as oe,H as ne,e as re,F as ce,g as d,f as ie,I as ue,y as de,l as T,Y as me,Z as _e,r as o,o as y,n as g,w as l,a as e,E as I,q as p,t as m,S as V,T as D,m as n,b,U as fe,L as pe,J as h}from"./main.d0ffa6eb.js";import{M as be}from"./MoonwalkerIcon.ec6772d4.js";import{_ as ve}from"./CreditNoteIndexDropdown.7ab40c4b.js";import{_ as Be}from"./SendInvoiceModal.67cc3524.js";const ye=b("div",{class:"hidden w-8 h-0 mx-4 border border-gray-400 border-solid xl:block",style:{"margin-top":"1.5rem"}},null,-1),ge={class:"pt-6"},Ie={class:"flex"},he={class:"relative flex items-center justify-between h-10 mt-5 list-none border-b-2 border-gray-200 border-solid"},Ce={class:"relative table-container"},Ve={setup($e){const u=ae();se(),le(),oe();const U=ne(),{t:r}=re();ce("$utils");const v=d(null),_=d(!1);d([{label:"Status",options:["DRAFT","DUE","SENT","VIEWED","OVERDUE","COMPLETED"]},{label:"Paid Status",options:["UNPAID","PAID","PARTIALLY_PAID"]},,]);const C=d(!0),N=d(!0),$=d("general.draft");ie();const O=ue();let a=de({customer_id:"",status:"",from_date:"",to_date:"",credit_number:""});const P=T(()=>!u.creditTotalCount&&!C.value);T({get:()=>u.selectedInvoices,set:s=>u.selectInvoice(s)});const R=T(()=>[{key:"credit_date",label:r("invoices.date"),thClass:"extra",tdClass:"font-medium"},{key:"credit_number",label:r("invoices.number")},{key:"name",label:r("invoices.customer")},{key:"status",label:r("invoices.status")},{key:"total",label:r("invoices.total"),tdClass:"font-medium text-gray-900"},{key:"actions",label:r("invoices.action"),tdClass:"text-right text-sm font-medium",thClass:"text-right",sortable:!1}]);me(a,()=>{G()},{debounce:500}),_e(()=>{u.selectAllField&&u.selectAllInvoices()});function L(){return O.hasAbilities([h.DELETE_INVOICE,h.EDIT_INVOICE,h.VIEW_INVOICE,h.SEND_INVOICE])}function M(){v.value&&v.value.refresh()}async function W({page:s,filter:c,sort:f}){let k={customer_id:a.customer_id,status:a.status,from_date:a.from_date,to_date:a.to_date,invoice_number:a.invoice_number,orderByField:f.fieldName||"created_at",orderBy:f.order||"desc",page:s};C.value=!0;let i=await u.fetchCreditNotes(k);return N.value=i.data.data.length>0,C.value=!1,{data:i.data.data,pagination:{totalPages:i.data.meta.last_page,currentPage:s,totalCount:i.data.meta.total,limit:10}}}function x(s){if($.value==s.title)return!0;switch($.value=s.title,s.title){case r("general.draft"):a.status="DRAFT";break;case r("general.sent"):a.status="SENT";break;case r("general.due"):a.status="DUE";break;default:a.status="";break}}function G(){u.$patch(s=>{s.selectedInvoices=[],s.selectAllField=!1}),M()}function F(){a.customer_id="",a.from_date="",a.to_date="",a.invoice_number="",$.value=r("general.all")}function H(){_.value&&F(),_.value=!_.value}return(s,c)=>{const f=o("BaseBreadcrumbItem"),k=o("BaseBreadcrumb"),i=o("BaseIcon"),E=o("BaseButton"),S=o("router-link"),j=o("BasePageHeader"),q=o("BaseCustomerSelectInput"),B=o("BaseInputGroup"),A=o("BaseDatePicker"),Y=o("BaseInput"),z=o("BaseFilterWrapper"),w=o("BaseTab"),J=o("BaseTabGroup"),X=o("BaseEmptyPlaceholder"),Z=o("BaseText"),K=o("BaseFormatMoney"),Q=o("BaseInvoiceStatusBadge"),ee=o("BaseTable"),te=o("BasePage");return y(),g(te,null,{default:l(()=>[e(Be),e(j,{title:s.$t("creditnote.title")},{actions:l(()=>[e(E,{variant:"primary-outline",onClick:H},{right:l(t=>[_.value?(y(),g(i,{key:1,name:"XIcon",class:I(t.class)},null,8,["class"])):(y(),g(i,{key:0,name:"FilterIcon",class:I(t.class)},null,8,["class"]))]),default:l(()=>[p(m(s.$t("creditnote.search"))+" ",1)]),_:1}),e(S,{to:"credit-note/create"},{default:l(()=>[e(E,{variant:"primary",class:"ml-4"},{left:l(t=>[e(i,{name:"PlusIcon",class:I(t.class)},null,8,["class"])]),default:l(()=>[p(" "+m(s.$t("creditnote.create")),1)]),_:1})]),_:1})]),default:l(()=>[e(k,null,{default:l(()=>[e(f,{title:s.$t("general.home"),to:"dashboard"},null,8,["title"]),e(f,{title:s.$tc("creditnote.creditnotes",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),V(e(z,{onClear:F},{default:l(()=>[e(B,{label:s.$tc("customers.customer",1)},{default:l(()=>[e(q,{modelValue:n(a).customer_id,"onUpdate:modelValue":c[0]||(c[0]=t=>n(a).customer_id=t),placeholder:s.$t("customers.type_or_click"),"value-prop":"id",label:"name"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(B,{label:s.$t("general.from")},{default:l(()=>[e(A,{modelValue:n(a).from_date,"onUpdate:modelValue":c[1]||(c[1]=t=>n(a).from_date=t),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),ye,e(B,{label:s.$t("general.to"),class:"mt-2"},{default:l(()=>[e(A,{modelValue:n(a).to_date,"onUpdate:modelValue":c[2]||(c[2]=t=>n(a).to_date=t),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),e(B,{label:s.$t("credits.number")},{default:l(()=>[e(Y,{modelValue:n(a).credit_number,"onUpdate:modelValue":c[3]||(c[3]=t=>n(a).credit_number=t)},{left:l(t=>[e(i,{name:"HashtagIcon",class:I(t.class)},null,8,["class"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),b("div",ge,[N.value?(y(),g(S,{key:0,to:`/filtered-credits-list?selectedCompany=${n(U).selectedCompany.id}&customer_id=${n(a).customer_id}&status=${n(a).status}&from_date=${n(a).from_date}&to_date=${n(a).to_date}&invoice_number=${n(a).credit_number}`,target:"_blank"},{default:l(()=>[e(E,{class:"mr-3",variant:"primary-outline",type:"button"},{default:l(()=>[b("span",Ie,m(s.$t("Download")),1)]),_:1})]),_:1},8,["to"])):fe("",!0)])]),_:1},512),[[D,_.value]]),b("div",he,[e(J,{class:"-mb-5",onChange:x},{default:l(()=>[e(w,{title:s.$t("general.allcreditnotes"),filter:""},null,8,["title"]),e(w,{title:s.$t("general.sent"),filter:"SENT"},null,8,["title"])]),_:1})]),V(e(X,{title:s.$t("credits.no_credits"),description:s.$t("credits.list_of_credit_notes")},{default:l(()=>[e(be,{class:"mt-5 mb-4"})]),_:1},8,["title","description"]),[[D,n(P)]]),V(b("div",Ce,[e(ee,{ref_key:"table",ref:v,data:W,columns:n(R),"placeholder-count":n(u).invoiceTotalCount>=20?10:5,class:"mt-10"},pe({"cell-name":l(({row:t})=>[e(Z,{text:t.data.customer.name,length:30},null,8,["text"])]),"cell-credit_number":l(({row:t})=>[e(S,{to:{path:`credit-note/${t.data.id}/view`},class:"font-medium text-primary-500"},{default:l(()=>[p(m(t.data.credit_number),1)]),_:2},1032,["to"])]),"cell-credit_date":l(({row:t})=>[p(m(t.data.formatted_credit_date),1)]),"cell-total":l(({row:t})=>[e(K,{amount:t.data.total,currency:t.data.customer.currency},null,8,["amount","currency"])]),"cell-status":l(({row:t})=>[e(Q,{status:t.data.status,class:"px-3 py-1"},{default:l(()=>[p(m(t.data.status),1)]),_:2},1032,["status"])]),_:2},[L()?{name:"cell-actions",fn:l(({row:t})=>[e(ve,{row:t.data,table:v.value},null,8,["row","table"])])}:void 0]),1032,["columns","placeholder-count"])],512),[[D,!n(P)]])]),_:1})}}};export{Ve as default};
