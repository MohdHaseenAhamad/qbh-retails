import{R as re,u as ne,e as H,a1 as z,x as ue,I as Z,Q as G,F as ee,r as i,o as v,n as w,w as n,a as s,m as e,J as U,q as h,t as T,U as A,g as L,c as N,ax as ie,s as te,y as X,l as D,a6 as de,h as q,i as M,ak as me,k as ce,b as O,p as W,a9 as pe,E as j,aa as _e,D as fe,a7 as F,L as ve}from"./main.d0ffa6eb.js";const ye={props:{row:{type:Object,default:null},table:{type:Object,default:null},loadData:{type:Function,default:null}},setup($){const d=$,t=re();ne();const{t:u}=H(),f=z();ue();const p=Z(),m=G();ee("utils");async function c(C){await f.fetchCustomField(C),m.openModal({title:u("settings.custom_fields.edit_custom_field"),componentName:"CustomFieldModal",size:"sm",data:C,refreshData:d.loadData})}async function S(C){t.openDialog({title:u("general.are_you_sure"),message:u("settings.custom_fields.custom_field_confirm_delete"),yesLabel:u("general.ok"),noLabel:u("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async b=>{b&&(await f.deleteCustomFields(C),d.loadData&&d.loadData())})}return(C,b)=>{const _=i("BaseIcon"),I=i("BaseDropdownItem"),V=i("BaseDropdown");return v(),w(V,null,{activator:n(()=>[s(_,{name:"DotsHorizontalIcon",class:"h-5 text-gray-500"})]),default:n(()=>[e(p).hasAbilities(e(U).EDIT_CUSTOM_FIELDS)?(v(),w(I,{key:0,onClick:b[0]||(b[0]=a=>c($.row.id))},{default:n(()=>[s(_,{name:"PencilIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),h(" "+T(C.$t("general.edit")),1)]),_:1})):A("",!0),e(p).hasAbilities(e(U).DELETE_CUSTOM_FIELDS)?(v(),w(I,{key:1,onClick:b[1]||(b[1]=a=>S($.row.id))},{default:n(()=>[s(_,{name:"TrashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),h(" "+T(C.$t("general.delete")),1)]),_:1})):A("",!0)]),_:1})}}},Ce={class:"flex items-center mt-1"},be={emits:["onAdd"],setup($,{emit:d}){const t=L(null);function u(){if(t.value==null||t.value==""||t.value==null)return!0;d("onAdd",t.value),t.value=null}return(f,p)=>{const m=i("BaseInput"),c=i("BaseIcon");return v(),N("div",Ce,[s(m,{modelValue:t.value,"onUpdate:modelValue":p[0]||(p[0]=S=>t.value=S),type:"text",class:"w-full md:w-96",placeholder:f.$t("settings.custom_fields.press_enter_to_add"),onClick:u,onKeydown:ie(te(u,["prevent","stop"]),["enter"])},null,8,["modelValue","placeholder","onKeydown"]),s(c,{name:"PlusCircleIcon",class:"ml-1 text-primary-500 cursor-pointer",onClick:u})])}}};function ge($){switch($){case"../../custom-fields/types/DateTimeType.vue":return F(()=>import("./DateTimeType.72426cb5.js"),["assets/DateTimeType.72426cb5.js","assets/main.d0ffa6eb.js","assets/main.7879e0c3.css"]);case"../../custom-fields/types/DateType.vue":return F(()=>import("./DateType.3dcce8ff.js"),["assets/DateType.3dcce8ff.js","assets/main.d0ffa6eb.js","assets/main.7879e0c3.css"]);case"../../custom-fields/types/DropdownType.vue":return F(()=>import("./DropdownType.26830148.js"),["assets/DropdownType.26830148.js","assets/main.d0ffa6eb.js","assets/main.7879e0c3.css"]);case"../../custom-fields/types/InputType.vue":return F(()=>import("./InputType.e2b133c7.js"),["assets/InputType.e2b133c7.js","assets/main.d0ffa6eb.js","assets/main.7879e0c3.css"]);case"../../custom-fields/types/NumberType.vue":return F(()=>import("./NumberType.0c268a0c.js"),["assets/NumberType.0c268a0c.js","assets/main.d0ffa6eb.js","assets/main.7879e0c3.css"]);case"../../custom-fields/types/PhoneType.vue":return F(()=>import("./PhoneType.9487e01b.js"),["assets/PhoneType.9487e01b.js","assets/main.d0ffa6eb.js","assets/main.7879e0c3.css"]);case"../../custom-fields/types/SwitchType.vue":return F(()=>import("./SwitchType.cdf90c35.js"),["assets/SwitchType.cdf90c35.js","assets/main.d0ffa6eb.js","assets/main.7879e0c3.css"]);case"../../custom-fields/types/TextAreaType.vue":return F(()=>import("./TextAreaType.247acd06.js"),["assets/TextAreaType.247acd06.js","assets/main.d0ffa6eb.js","assets/main.7879e0c3.css"]);case"../../custom-fields/types/TimeType.vue":return F(()=>import("./TimeType.95dadbc0.js"),["assets/TimeType.95dadbc0.js","assets/main.d0ffa6eb.js","assets/main.7879e0c3.css"]);case"../../custom-fields/types/UrlType.vue":return F(()=>import("./UrlType.16da7cd4.js"),["assets/UrlType.16da7cd4.js","assets/main.d0ffa6eb.js","assets/main.7879e0c3.css"]);default:return new Promise(function(d,t){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(t.bind(null,new Error("Unknown variable dynamic import: "+$)))})}}const Fe={class:"flex justify-between w-full"},we=["onSubmit"],$e={class:"overflow-y-auto max-h-[550px]"},Te={class:"px-4 md:px-8 py-8 overflow-y-auto sm:p-6"},Ie={class:"z-0 flex justify-end p-4 border-t border-solid border-gray-light border-modal-bg"},Ve={setup($){const d=G(),t=z(),{t:u}=H();let f=L(!1);const p=X(["Customer","Invoice","Estimate","Expense","Payment"]),m=X([{label:"Text",value:"Input"},{label:"Textarea",value:"TextArea"},{label:"Phone",value:"Phone"},{label:"URL",value:"Url"},{label:"Number",value:"Number"},{label:"Select Field",value:"Dropdown"},{label:"Switch Toggle",value:"Switch"},{label:"Date",value:"Date"},{label:"Time",value:"Time"},{label:"Date & Time",value:"DateTime"}]);let c=L(m[0]);const S=D(()=>d.active&&d.componentName==="CustomFieldModal"),C=D(()=>c.value&&c.value.label==="Switch Toggle"),b=D(()=>c.value&&c.value.label==="Select Field"),_=D(()=>t.currentCustomField.type?de(()=>ge(`../../custom-fields/types/${t.currentCustomField.type}Type.vue`)):!1),I=D({get:()=>t.currentCustomField.is_required===1,set:l=>{const o=l?1:0;t.currentCustomField.is_required=o}}),V=D(()=>({currentCustomField:{type:{required:q.withMessage(u("validation.required"),M)},name:{required:q.withMessage(u("validation.required"),M)},label:{required:q.withMessage(u("validation.required"),M)},model_type:{required:q.withMessage(u("validation.required"),M)},order:{required:q.withMessage(u("validation.required"),M),numeric:q.withMessage(u("validation.numbers_only"),me)},type:{required:q.withMessage(u("validation.required"),M)}}})),a=ce(V,D(()=>t));function E(){t.isEdit?c.value=m.find(l=>l.value==t.currentCustomField.type):(t.currentCustomField.model_type=p[0],t.currentCustomField.type=m[0].value)}async function P(){if(a.value.currentCustomField.$touch(),a.value.currentCustomField.$invalid)return!0;f.value=!0;let l={...t.currentCustomField};if(t.currentCustomField.options&&(l.options=t.currentCustomField.options.map(k=>k.name)),l.type=="Time"&&typeof l.default_answer=="object"){let k=l&&l.default_answer&&l.default_answer.HH?l.default_answer.HH:null,B=l&&l.default_answer&&l.default_answer.mm?l.default_answer.mm:null;l&&l.default_answer&&l.default_answer.ss&&l.default_answer.ss,l.default_answer=`${k}:${B}`}await(t.isEdit?t.updateCustomField:t.addCustomField)(l),f.value=!1,d.refreshData&&d.refreshData(),R()}function x(l){t.currentCustomField.options=[{name:l},...t.currentCustomField.options]}function y(l){if(t.isEdit&&t.currentCustomField.in_use)return;t.currentCustomField.options[l].name===t.currentCustomField.default_answer&&(t.currentCustomField.default_answer=null),t.currentCustomField.options.splice(l,1)}function le(l){t.currentCustomField.type=l.value}function R(){d.closeModal(),setTimeout(()=>{t.resetCurrentCustomField(),a.value.$reset()},300)}return(l,o)=>{const k=i("BaseIcon"),B=i("BaseInput"),g=i("BaseInputGroup"),K=i("BaseMultiselect"),se=i("BaseSwitch"),oe=i("BaseInputGrid"),Y=i("BaseButton"),ae=i("BaseModal");return v(),w(ae,{show:e(S),onOpen:E},{header:n(()=>[O("div",Fe,[h(T(e(d).title)+" ",1),s(k,{name:"XIcon",class:"w-6 h-6 text-gray-500 cursor-pointer",onClick:R})])]),default:n(()=>[O("form",{action:"",onSubmit:te(P,["prevent"])},[O("div",$e,[O("div",Te,[s(oe,{layout:"one-column"},{default:n(()=>[s(g,{label:l.$t("settings.custom_fields.name"),required:"",error:e(a).currentCustomField.name.$error&&e(a).currentCustomField.name.$errors[0].$message},{default:n(()=>[s(B,{ref:"name",modelValue:e(t).currentCustomField.name,"onUpdate:modelValue":o[0]||(o[0]=r=>e(t).currentCustomField.name=r),invalid:e(a).currentCustomField.name.$error,onInput:o[1]||(o[1]=r=>e(a).currentCustomField.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),s(g,{label:l.$t("settings.custom_fields.model"),error:e(a).currentCustomField.model_type.$error&&e(a).currentCustomField.model_type.$errors[0].$message,"help-text":e(t).currentCustomField.in_use?l.$t("settings.custom_fields.model_in_use"):"",required:""},{default:n(()=>[s(K,{modelValue:e(t).currentCustomField.model_type,"onUpdate:modelValue":o[2]||(o[2]=r=>e(t).currentCustomField.model_type=r),options:e(p),"can-deselect":!1,invalid:e(a).currentCustomField.model_type.$error,searchable:!0,disabled:e(t).currentCustomField.in_use,onInput:o[3]||(o[3]=r=>e(a).currentCustomField.model_type.$touch())},null,8,["modelValue","options","invalid","disabled"])]),_:1},8,["label","error","help-text"]),s(g,{class:"flex items-center space-x-4",label:l.$t("settings.custom_fields.required")},{default:n(()=>[s(se,{modelValue:e(I),"onUpdate:modelValue":o[4]||(o[4]=r=>W(I)?I.value=r:null)},null,8,["modelValue"])]),_:1},8,["label"]),s(g,{label:l.$t("settings.custom_fields.type"),error:e(a).currentCustomField.type.$error&&e(a).currentCustomField.type.$errors[0].$message,"help-text":e(t).currentCustomField.in_use?l.$t("settings.custom_fields.type_in_use"):"",required:""},{default:n(()=>[s(K,{modelValue:e(c),"onUpdate:modelValue":[o[5]||(o[5]=r=>W(c)?c.value=r:c=r),le],options:e(m),invalid:e(a).currentCustomField.type.$error,disabled:e(t).currentCustomField.in_use,searchable:!0,"can-deselect":!1,object:""},null,8,["modelValue","options","invalid","disabled"])]),_:1},8,["label","error","help-text"]),s(g,{label:l.$t("settings.custom_fields.label"),required:"",error:e(a).currentCustomField.label.$error&&e(a).currentCustomField.label.$errors[0].$message},{default:n(()=>[s(B,{modelValue:e(t).currentCustomField.label,"onUpdate:modelValue":o[6]||(o[6]=r=>e(t).currentCustomField.label=r),invalid:e(a).currentCustomField.label.$error,onInput:o[7]||(o[7]=r=>e(a).currentCustomField.label.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),s(g,{label:l.$t("settings.custom_fields.label_another")},{default:n(()=>[s(B,{modelValue:e(t).currentCustomField.label_ar,"onUpdate:modelValue":o[8]||(o[8]=r=>e(t).currentCustomField.label_ar=r)},null,8,["modelValue"])]),_:1},8,["label"]),e(b)?(v(),w(g,{key:0,label:l.$t("settings.custom_fields.options")},{default:n(()=>[s(be,{onOnAdd:x}),(v(!0),N(_e,null,pe(e(t).currentCustomField.options,(r,J)=>(v(),N("div",{key:J,class:"flex items-center mt-5"},[s(B,{modelValue:r.name,"onUpdate:modelValue":Q=>r.name=Q,class:"w-64"},null,8,["modelValue","onUpdate:modelValue"]),s(k,{name:"MinusCircleIcon",class:j(["ml-1 cursor-pointer",e(t).currentCustomField.in_use?"text-gray-300":"text-red-300"]),onClick:Q=>y(J)},null,8,["class","onClick"])]))),128))]),_:1},8,["label"])):A("",!0),s(g,{label:l.$t("settings.custom_fields.default_value"),class:"relative"},{default:n(()=>[(v(),w(fe(e(_)),{modelValue:e(t).currentCustomField.default_answer,"onUpdate:modelValue":o[9]||(o[9]=r=>e(t).currentCustomField.default_answer=r),options:e(t).currentCustomField.options,"default-date-time":e(t).currentCustomField.dateTimeValue},null,8,["modelValue","options","default-date-time"]))]),_:1},8,["label"]),e(C)?A("",!0):(v(),w(g,{key:1,label:l.$t("settings.custom_fields.placeholder")},{default:n(()=>[s(B,{modelValue:e(t).currentCustomField.placeholder,"onUpdate:modelValue":o[10]||(o[10]=r=>e(t).currentCustomField.placeholder=r)},null,8,["modelValue"])]),_:1},8,["label"])),s(g,{label:l.$t("settings.custom_fields.order"),error:e(a).currentCustomField.order.$error&&e(a).currentCustomField.order.$errors[0].$message,required:""},{default:n(()=>[s(B,{modelValue:e(t).currentCustomField.order,"onUpdate:modelValue":o[11]||(o[11]=r=>e(t).currentCustomField.order=r),type:"number",invalid:e(a).currentCustomField.order.$error,onInput:o[12]||(o[12]=r=>e(a).currentCustomField.order.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),_:1})])]),O("div",Ie,[s(Y,{class:"mr-3",type:"button",variant:"primary-outline",onClick:R},{default:n(()=>[h(T(l.$t("general.cancel")),1)]),_:1}),s(Y,{variant:"primary",loading:e(f),disabled:e(f),type:"submit"},{left:n(r=>[e(f)?A("",!0):(v(),w(k,{key:0,class:j(r.class),name:"SaveIcon"},null,8,["class"]))]),default:n(()=>[h(" "+T(e(t).isEdit?l.$t("general.update"):l.$t("general.save")),1)]),_:1},8,["loading","disabled"])])],40,we)]),_:1},8,["show"])}}},Be={class:"text-xs text-gray-500"},he={setup($){const d=G(),t=z(),u=Z(),f=ee("utils"),{t:p}=H(),m=L(null),c=D(()=>[{key:"name",label:p("settings.custom_fields.name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"model_type",label:p("settings.custom_fields.model")},{key:"type",label:p("settings.custom_fields.type")},{key:"is_required",label:p("settings.custom_fields.required")},{key:"actions",label:"",tdClass:"text-right text-sm font-medium",sortable:!1}]);async function S({page:_,filter:I,sort:V}){let a={orderByField:V.fieldName||"created_at",orderBy:V.order||"desc",page:_},E=await t.fetchCustomFields(a);return{data:E.data.data,pagination:{totalPages:E.data.meta.last_page,currentPage:_,limit:5,totalCount:E.data.meta.total}}}function C(){d.openModal({title:p("settings.custom_fields.add_custom_field"),componentName:"CustomFieldModal",size:"sm",refreshData:m.value&&m.value.refresh})}async function b(){m.value&&m.value.refresh()}return(_,I)=>{const V=i("BaseIcon"),a=i("BaseButton"),E=i("BaseBadge"),P=i("BaseTable"),x=i("BaseSettingCard");return v(),w(x,{title:_.$t("settings.menu_title.custom_fields"),description:_.$t("settings.custom_fields.section_description")},{action:n(()=>[e(u).hasAbilities(e(U).CREATE_CUSTOM_FIELDS)?(v(),w(a,{key:0,variant:"primary-outline",onClick:C},{left:n(y=>[s(V,{class:j(y.class),name:"PlusIcon"},null,8,["class"]),h(" "+T(_.$t("settings.custom_fields.add_custom_field")),1)]),_:1})):A("",!0)]),default:n(()=>[s(Ve),s(P,{ref_key:"table",ref:m,data:S,columns:e(c),class:"mt-16"},ve({"cell-name":n(({row:y})=>[h(T(y.data.name)+" ",1),O("span",Be," ("+T(y.data.slug)+")",1)]),"cell-is_required":n(({row:y})=>[s(E,{"bg-color":e(f).getBadgeStatusColor(y.data.is_required?"YES":"NO").bgColor,color:e(f).getBadgeStatusColor(y.data.is_required?"YES":"NO").color},{default:n(()=>[h(T(y.data.is_required?_.$t("settings.custom_fields.yes"):_.$t("settings.custom_fields.no").replace("_"," ")),1)]),_:2},1032,["bg-color","color"])]),_:2},[e(u).hasAbilities([e(U).DELETE_CUSTOM_FIELDS,e(U).EDIT_CUSTOM_FIELDS])?{name:"cell-actions",fn:n(({row:y})=>[s(ye,{row:y.data,table:m.value,"load-data":b},null,8,["row","table"])])}:void 0]),1032,["columns"])]),_:1},8,["title","description"])}}};export{he as default};
